function Config(){}function startup(){game=new Phaser.Game(Config.WIDTH,Config.HEIGHT,Phaser.CANVAS,"gameArea"),game.state.add("Boot",App.BootState),game.state.add("Preloader",App.PreloaderState),game.state.add("MainMenu",App.MainMenuState),game.state.add("Gameplay",App.GameplayState),game.state.start("Boot")}App.Commands=Class.extend({init:function(){this.releaseCoinSignal=new Phaser.Signal,this.taskStartSignal=new Phaser.Signal,this.taskCompleteSignal=new Phaser.Signal,this.levelCompleteSignal=new Phaser.Signal},gameStart:function(){Config.TEST_GAME_COMPLETE?cmd.gameComplete():cmd.levelStart(Config.START_LEVEL)},levelStart:function(a){data.curLevel=data.levels[a],data.curTask=0,game.state.start("Gameplay")},levelComplete:function(){game.state.getCurrentState().levelComplete(),data.curLevel.complete(),cookies.levelComplete(),sounds.play("sndLevelComplete")},levelNext:function(){var a=data.curLevel.id,b=data.levels[a+1];b?fader.fade(this.gotoNextLevel,this):cmd.gameComplete()},gotoNextLevel:function(){var a=data.curLevel.id;cmd.levelStart(a+1)},gameComplete:function(){fader.fade(this.doGameComplete,this)},doGameComplete:function(){game.state.start("GameComplete")}}),Config.VERSION="0.1",Config.WIDTH=800,Config.HEIGHT=600,Config.LANGUAGE="en",Config.ANIMATION=!1,Config.SOUNDS_ENABLED=!1,Config.TRANSPARENT=!1,Config.START_LEVEL=0,Config.TEST_GAME_COMPLETE=!1,Config.SHOW_FPS=!0,Config.OPEN_ALL_LEVELS=!0,Config.ENABLE_CHEAT=!1,Config.RELEASE=!1,Config.RELEASE&&(Config.ANIMATION=!0,Config.SOUNDS_ENABLED=!0,Config.TRANSPARENT=!1,Config.START_LEVEL=0,Config.TEST_GAME_COMPLETE=!1,Config.SHOW_FPS=!1,Config.OPEN_ALL_LEVELS=!1,Config.ENABLE_CHEAT=!1),App.Data=Class.extend({init:function(){this.curLevel=null,this.curTask=null,this.taskCoins=null,this.initLevels(),this.atlasName="atlas"},getAtlasKey:function(a){return this.atlasName+"/"+a+"_0000"},addAtlasSprite:function(a,b){var c=util.getParam(b,"x",0),d=util.getParam(b,"y",0),e=util.getParam(b,"center",!1),f=util.getParam(b,"parent",game.world),g=game.add.sprite(c,d,this.atlasName,this.getAtlasKey(a),f);return e&&g.anchor.set(.5,.5),g},initLevels:function(){this.levels=[],this.addRandomLevel(1),this.addRandomLevel(2),this.addRandomLevel(3),this.addRandomLevel(4),this.addRandomLevel(5),this.addRandomLevel(6),this.addRandomLevel(7),this.addRandomLevel(8),this.addRandomLevel(9),this.addRandomLevel(10),this.addLevel([{coins:[.1]},{coins:[.5]},{coins:[1]},{coins:[2]},{coins:[5]},{coins:[.1,.1]},{coins:[.5,1]},{coins:[.1,1]},{coins:[2,5]},{coins:[.5,1,5]}]),this.addLevel([{coins:[1]},{coins:[5]},{coins:[1,5]},{coins:[1,1,1]}])},addLevel:function(a){var b=this.levels.length,c=new App.Level(b,a);this.levels.push(c)},addRandomLevel:function(a){var b,c=[];for(b=0;5>b;b++)c.push({coins:this.getRandomCoins(a)});for(b=0;4>b;b++)c.push({coins:this.getRandomCoins(a+1)});c.push({coins:this.getRandomCoins(a+2)}),this.addLevel(c)},getRandomCoins:function(a){for(var b=[.1,.5,1,2,5],c=[],d=0;a>d;d++){var e=Math.floor(Math.random()*b.length),f=b[e];c.push(f)}return c},getTaskCoinsSum:function(){for(var a=0,b=0;b<this.taskCoins.length;b++)a+=this.taskCoins[b];return a.toFixed(2)}}),App.Dialog=Class.extend({init:function(a,b){var c=util.getParam(b,"x",0),d=util.getParam(b,"y",0),e=util.getParam(b,"blockBack",!1),f=util.getParam(b,"doTween",!0);this.holder=new Phaser.Group(game,game.world),e&&(this.block=new Phaser.Sprite(game,0,0,"blackBack"),this.block.inputEnabled=!0,this.holder.add(this.block)),this.boxHolder=new Phaser.Group(game,this.holder),this.boxHolder.x=c,this.boxHolder.y=d,this.box=data.addAtlasSprite(a,{parent:this.boxHolder,center:!0}),f&&(this.boxHolder.alpha=0,this.boxHolder.scale.x=this.boxHolder.scale.y=.5,game.add.tween(this.boxHolder).to({alpha:1},500,Phaser.Easing.Linear.None,!0),game.add.tween(this.boxHolder.scale).to({x:1,y:1},500,Phaser.Easing.Back.Out,!0),e&&(this.block.alpha=0,game.add.tween(this.block).to({alpha:1},200,Phaser.Easing.Linear.None,!0)))},dissapear:function(){var a=game.add.tween(this.boxHolder).to({alpha:0},500,Phaser.Easing.Linear.None,!0);a.onComplete.add(this.destroy,this),game.add.tween(this.boxHolder).to({y:this.boxHolder.y-300},500,Phaser.Easing.Back.In,!0),game.add.tween(this.block).to({alpha:0},200,Phaser.Easing.Linear.None,!0)},destroy:function(){this.holder.destroy()}}),App.Level=Class.extend({init:function(a,b){this.id=a,this.tasks=b,this.reset()},reset:function(){this.isCompleted=!1},complete:function(){this.isCompleted=!0}});var game,cmd,data,cookies,fader,sounds,util;App.Sounds=Class.extend({init:function(){this.musicChannel=void 0},startMusic:function(){Config.SOUNDS_ENABLED&&(this.musicChannel=game.add.audio("music",1,!0),this.musicChannel.play())},stopMusic:function(){this.musicChannel&&this.musicChannel.pause()},play:function(a,b){var c=1;void 0!=b&&(c=b),Config.SOUNDS_ENABLED&&game.sound.play(a,c)}}),App.Util=Class.extend({init:function(){},getParam:function(a,b,c){return a&&"undefined"!=typeof a[b]?a[b]:c},pulse:function(a,b){void 0==b&&(b=1.2),game.add.tween(a.scale).to({x:b,y:b},1e3,Phaser.Easing.Sinusoidal.InOut).to({x:1,y:1},1e3,Phaser.Easing.Sinusoidal.InOut).loop().start()},wobble:function(a,b){void 0==b&&(b=1);for(var c=game.add.tween(a.scale),d=0;b>d;d++){var c=c.to({x:1.2,y:.8},100,Phaser.Easing.Sinusoidal.InOut);c.to({x:1,y:1},100,Phaser.Easing.Sinusoidal.InOut)}c.start()},tweenWithAlpha:function(a,b){a.alpha=0,game.add.tween(a).to({alpha:1},500,Phaser.Easing.Linear.None,!0,b)},formatTime:function(a){var b=Math.floor(a/1e3),c=Math.floor(b/3600),d=Math.floor((b-3600*c)/60),e=b-3600*c-60*d;return 10>c&&(c="0"+c),10>d&&(d="0"+d),10>e&&(e="0"+e),d+":"+e},randomizeArray:function(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return a},randomizeAndCopyArray:function(a){var b=a.slice();return this.randomizeArray(b)},equalArrays:function(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0},getDist:function(a,b,c,d){var e=a-c,f=b-d;return Math.sqrt(e*e+f*f)}}),App.Coin=Class.extend({init:function(a,b,c,d){this.value=c,this.parent=d,this.group=game.add.group(d),this.defaultsPos=new Phaser.Point(a,b),this.reset(),this.radius=40;var e="";.1==this.value?(e="coin10kop",this.radius=35):.5==this.value?(e="coin50kop",this.radius=40):1==this.value?(e="coin1Rouble",this.radius=40):2==this.value?(e="coin2Roubles",this.radius=46):5==this.value&&(e="coin5Roubles",this.radius=50),this.sprite=data.addAtlasSprite(e,{center:!0,parent:this.group})},reset:function(){this.setPos(this.defaultsPos.x,this.defaultsPos.y)},getX:function(){return this.group.x},getY:function(){return this.group.y},setPos:function(a,b){this.group.x=a,this.group.y=b},isPointInside:function(a,b){var c=this.getX()-a,d=this.getY()-b,e=Math.sqrt(c*c+d*d);return e<=this.radius?!0:!1},toTop:function(){this.parent.bringToTop(this.group)},moveAndDestroy:function(a,b){game.add.tween(this.group).to({x:a,y:b},500,Phaser.Easing.Quadratic.InOut,!0);var c=game.add.tween(this.group.scale).to({x:.2,y:.2},500,Phaser.Easing.Quadratic.InOut,!0);c.onComplete.addOnce(this.tweenComplete,this)},tweenComplete:function(){this.destroy()},destroy:function(){this.parent.remove(this.group)}}),App.Fader=Class.extend({init:function(a){this.game=a},fade:function(a,b){if(this.callback=a,this.scope=b,Config.ANIMATION){this.pic=game.add.sprite(0,0,"fader"),this.pic.alpha=0,this.pic.inputEnabled=!0;var c=game.add.tween(this.pic).to({alpha:.8},300,Phaser.Easing.Linear.None,!0);c.onComplete.addOnce(this.fadeInComplete,this)}else this.callback.call(this.scope)},fadeInComplete:function(){App.Fader.SHOULD_FADE_OUT=!0,this.callback.call(this.scope)},fadeOut:function(){App.Fader.SHOULD_FADE_OUT=!1,this.pic=game.add.sprite(0,0,"fader"),this.pic.inputEnabled=!0;var a=game.add.tween(this.pic).to({alpha:0},300,Phaser.Easing.Linear.None,!0);a.onComplete.addOnce(this.fadeOutComplete,this)},fadeOutComplete:function(){this.pic.destroy()}}),App.Fader.SHOULD_FADE_OUT=!1,App.GameLogic=Class.extend({init:function(){this.spritesGroup=game.add.group(game.world),this.coinsGroup=game.add.group(game.world),cmd.taskStartSignal.add(this.taskStartHandler,this),cmd.taskCompleteSignal.add(this.taskCompleteHandler,this),cmd.levelCompleteSignal.add(this.levelCompleteHandler,this),this.table=new App.Table(this.spritesGroup,this.coinsGroup),this.wallet=new App.Wallet(this.spritesGroup,this.coinsGroup),this.createTaskItems(),cmd.taskStartSignal.dispatch()},createTaskItems:function(){this.taskItems=[];for(var a=0;a<data.curLevel.tasks.length;a++){var b=new App.TaskItem(a,data.curLevel.tasks[a],this.spritesGroup);this.taskItems.push(b)}},taskStartHandler:function(){data.taskCoins=data.curLevel.tasks[data.curTask].coins,console.log("Task Start",data.taskCoins.toString()),this.taskItems[data.curTask].start()},taskCompleteHandler:function(){this.taskItems[data.curTask].complete(),console.log("Task complete!"),data.curTask++,data.curTask==data.curLevel.tasks.length?cmd.levelCompleteSignal.dispatch():cmd.taskStartSignal.dispatch()},levelCompleteHandler:function(){console.log("yo! level complete!"),new App.LevelCompleteView},update:function(){this.wallet.update(),this.table.update()},destroy:function(){cmd.taskStartSignal.remove(this.taskStartHandler,this),cmd.taskCompleteSignal.remove(this.taskCompleteHandler,this),cmd.levelCompleteSignal.remove(this.levelCompleteHandler,this),this.table.destroy(),this.wallet.destroy()}}),App.GameTitle=Class.extend({init:function(a,b){this.group=game.add.group(),this.group.x=a,this.group.y=b;var c="Мелочь, а приятно!",d=game.add.text(0,0,c,{font:"38px Arial",fill:"#000000"},this.group);d.anchor.set(.5,.5)},update:function(){}}),App.LevelCompleteView=App.Dialog.extend({init:function(){this._super("levelCompleteBox",{x:400,y:300,blockBack:!1}),this.next=new App.MyButton("nextButton",this.nextClick,this,{x:0,y:30,center:!0,parentGroup:this.boxHolder,wobble:!0})},nextClick:function(){this.next.disableClick(),data.curLevel.id==data.levels.length-1?console.log("game complete!"):fader.fade(this.nextLevel,this)},nextLevel:function(){cmd.levelStart(data.curLevel.id+1)}}),App.MyButton=Class.extend({init:function(a,b,c,d){this.callback=b,this.callbackContext=c;var e=util.getParam(d,"x",0),f=util.getParam(d,"y",0),g=util.getParam(d,"center",!1),h=util.getParam(d,"parentGroup",game.world),i=util.getParam(d,"atlas",!0);if(this.wobble=util.getParam(d,"wobble",!1),i){var j=data.getAtlasKey(a);this.bt=game.add.button(e,f,data.atlasName,this.clickHandler,this,j,j,j,j,h)}else this.bt=game.add.button(e,f,a,this.clickHandler,this,null,null,null,null,h);this.bt.input.useHandCursor=!0,g&&this.bt.anchor.set(.5,.5)},clickHandler:function(){sounds.play("sndClick"),this.wobble&&util.wobble(this.bt),this.callback.call(this.callbackContext)},scaleHide:function(){game.add.tween(this.bt.scale).to({x:0,y:0},200,Phaser.Easing.Linear.None,!0)},scaleShow:function(){game.add.tween(this.bt.scale).to({x:1,y:1},200,Phaser.Easing.Linear.None,!0)},hide:function(){this.bt.scale.x=this.bt.scale.y=0},show:function(){this.bt.scale.x=this.bt.scale.y=1},disableClick:function(){this.bt.inputEnabled=!1},enableClick:function(){this.bt.inputEnabled=!0},destroy:function(){this.bt.destroy()}}),App.SoundIcon=Class.extend({init:function(a){var b=util.getParam(a,"x",0),c=util.getParam(a,"y",0),d=util.getParam(a,"scale",1),e=util.getParam(a,"parentGroup",game.world);this.group=game.add.group(e),this.group.x=b,this.group.y=c,this.group.scale.x=this.group.scale.y=d,this.btOn=new App.MyButton("soundIconOn",this.sndClick,this,{center:!0,parentGroup:this.group}),this.btOff=new App.MyButton("soundIconOff",this.sndClick,this,{center:!0,parentGroup:this.group}),this.updateIcon()},updateIcon:function(){Config.SOUNDS_ENABLED?(this.btOn.show(),this.btOff.hide()):(this.btOn.hide(),this.btOff.show())},hide:function(){this.group.visible=!1},sndClick:function(){Config.SOUNDS_ENABLED=!Config.SOUNDS_ENABLED,this.updateIcon(),util.wobble(this.group)},disableClick:function(){this.btOn.disableClick(),this.btOff.disableClick()}}),App.Table=Class.extend({init:function(a,b){this.coinsGroup=b,this.x=270,this.y=20,this.width=520,this.height=360,this.activeItem=null,this.dragOffset=void 0,this.sprite=data.addAtlasSprite("tableBack",{parent:a}),this.sprite.x=this.x,this.sprite.y=this.y,this.coins=[],this.sumTf=game.add.text(0,0,"0.00 руб",{font:"40px Arial",fill:"#000000"},a),this.sumTf.x=this.x+200,this.sumTf.y=this.y+5,cmd.releaseCoinSignal.add(this.releaseCoinHandler,this),game.input.onDown.add(this.touchDownHandler,this)},drawBounds:function(a){var b=game.add.graphics(this.x,this.y,a);b.lineStyle(2,0,1),b.drawRect(0,0,this.width,this.height)},updateSum:function(){this.sumTf.text=this.getCoinsTotal()+" руб"},getCoinsTotal:function(){for(var a=0,b=0;b<this.coins.length;b++){var c=this.coins[b];a+=c.value}return a.toFixed(2)},maybeTaskComplete:function(){this.coins.length==data.taskCoins.length&&this.getCoinsTotal()==data.getTaskCoinsSum()&&(this.clear(),cmd.taskCompleteSignal.dispatch())},clear:function(){for(var a=125,b=40+55*data.curTask+25,c=(new App.CoinsMover(this.coins,a,b),this.coins.length-1);c>=0;c--)this.removeCoin(this.coins[c]);this.updateSum()},touchDownHandler:function(a){var b=Math.round(a.x),c=Math.round(a.y),d=this.getCoinUnderPoint(b,c);d&&(this.activeItem=d,this.activeItem.toTop(),this.dragOffset=new Phaser.Point(b-d.getX(),c-d.getY()),game.input.onUp.add(this.touchUpHandler,this))},touchUpHandler:function(){game.input.onUp.remove(this.touchUpHandler,this),this.isPointInBounds(this.activeItem.getX(),this.activeItem.getY())||(this.removeCoin(this.activeItem),this.activeItem.destroy(),this.updateSum(),this.maybeTaskComplete()),this.activeItem=null},getCoinUnderPoint:function(a,b){for(var c=0;c<this.coins.length;c++){var d=this.coins[c];if(d.isPointInside(a,b))return d}},releaseCoinHandler:function(a){this.isPointInBounds(a.x,a.y)?(this.addCoin(a.x,a.y,a.value),this.updateSum(),this.maybeTaskComplete()):console.log("Nope :(")},addCoin:function(a,b,c){var d=new App.Coin(a,b,c,this.coinsGroup);this.coins.push(d)},removeCoin:function(a){var b=this.coins.indexOf(a);this.coins.splice(b,1)},isPointInBounds:function(a,b){var c=this.x,d=this.x+this.width,e=this.y,f=this.y+this.height;return a>=c&&d>=a&&b>=e&&f>=b?!0:!1},update:function(){if(this.activeItem){var a=game.input.activePointer,b=Math.round(a.position.x)-this.dragOffset.x,c=Math.round(a.position.y)-this.dragOffset.y;this.activeItem.setPos(b,c)}},destroy:function(){cmd.releaseCoinSignal.remove(this.releaseCoinHandler,this)}}),App.CoinsMover=Class.extend({init:function(a,b,c){this.coins=a;for(var d=0;d<this.coins.length;d++){var e=this.coins[d];e.moveAndDestroy(b,c)}}}),App.TaskItem=Class.extend({init:function(a,b,c){this.id=a,this.task=b,this.defaultX=5,this.defaultY=40+55*a;var d=this.defaultY;this.group=game.add.group(c),this.group.x=this.defaultX,this.group.y=d,this.sprite=data.addAtlasSprite("taskItemNormal",{parent:this.group});var e=this.task.coins.length.toString();this.coinsTf=game.add.text(10,3,e,{font:"40px Arial",fill:"#444444"},this.group);var f=this.getTaskTotal();this.totalTf=game.add.text(80,3,f,{font:"40px Arial",fill:"#000000"},this.group),this.rubTf=game.add.text(0,0,"руб",{font:"20px Arial",fill:"#000000"},this.group),this.rubTf.x=this.totalTf.x+this.totalTf.width+2,this.rubTf.y=this.totalTf.y+this.totalTf.height-this.rubTf.height-5},start:function(){this.group.remove(this.sprite),this.sprite=data.addAtlasSprite("taskItemActive",{parent:this.group}),this.group.sendToBack(this.sprite),game.add.tween(this.group).to({x:this.defaultX+25},300,Phaser.Easing.Quadratic.InOut,!0)},complete:function(){this.group.remove(this.sprite),this.sprite=data.addAtlasSprite("taskItemComplete",{parent:this.group}),this.group.sendToBack(this.sprite),game.add.tween(this.group).to({x:this.defaultX},300,Phaser.Easing.Quadratic.InOut,!0)},getTaskTotal:function(){for(var a=0,b=0;b<this.task.coins.length;b++)a+=this.task.coins[b];return a.toFixed(2)}}),App.Wallet=Class.extend({init:function(a,b){this.coinsGroup=b,this.x=417,this.y=400,this.activeItem=null,this.dragOffset=void 0,this.sprite=data.addAtlasSprite("walletBack",{parent:a}),this.sprite.x=this.x,this.sprite.y=this.y,this.coins=[],this.addCoin(77,68,.1),this.addCoin(135,137,.5),this.addCoin(192,63,1),this.addCoin(247,143,2),this.addCoin(323,67,5),cmd.levelCompleteSignal.add(this.levelCompleteHandler,this),game.input.onDown.add(this.touchDownHandler,this)},addCoin:function(a,b,c){var d=new App.Coin(this.x+a,this.y+b,c,this.coinsGroup);this.coins.push(d)},touchDownHandler:function(a){var b=Math.round(a.x),c=Math.round(a.y),d=this.getCoinUnderPoint(b,c);d&&(this.activeItem=d,this.activeItem.toTop(),this.dragOffset=new Phaser.Point(b-d.getX(),c-d.getY()),game.input.onUp.add(this.touchUpHandler,this))},touchUpHandler:function(){game.input.onUp.remove(this.touchUpHandler,this);var a=this.activeItem.getX(),b=this.activeItem.getY(),c=this.activeItem.value,d={x:a,y:b,value:c};cmd.releaseCoinSignal.dispatch(d),this.activeItem.reset(),this.activeItem=null},getCoinUnderPoint:function(a,b){for(var c=0;c<this.coins.length;c++){var d=this.coins[c];if(d.isPointInside(a,b))return d}},update:function(){if(this.activeItem){var a=game.input.activePointer,b=Math.round(a.position.x)-this.dragOffset.x,c=Math.round(a.position.y)-this.dragOffset.y;this.activeItem.setPos(b,c)}},levelCompleteHandler:function(){game.input.onDown.remove(this.touchDownHandler,this)},destroy:function(){cmd.levelCompleteSignal.remove(this.levelCompleteHandler,this)}}),App.BootState=function(){},App.BootState.prototype={preload:function(){this.load.image("preloadBar","assets/images/preloadBar.png"),this.load.image("preloadBarHolder","assets/images/preloadBarHolder.png"),this.load.image("background","assets/images/background.jpg"),this.load.image("cuteBack1.jpg","assets/images/cuteBack1.jpg"),game.stage.backgroundColor="#EBE7DA"},create:function(){this.game.input.maxPointers=1,Config.TRANSPARENT&&(this.game.world.alpha=.5),this.game.state.start("Preloader")},rescale:function(){var a=this.game;setTimeout(function(){a.scale.refresh()},500)}},App.GameplayState=function(){},App.GameplayState.prototype={create:function(){this.add.sprite(0,0,"cuteBack1.jpg"),this.home=new App.MyButton("backButton",this.homeClick,this,{x:302,y:553,center:!0,wobble:!0}),this.soundIcon=new App.SoundIcon({x:375,y:553}),this.logic=new App.GameLogic,App.Fader.SHOULD_FADE_OUT&&fader.fadeOut()},update:function(){this.logic.update()},homeClick:function(){fader.fade(this.gotoMainMenu,this)},gotoMainMenu:function(){game.state.start("MainMenu")},updateUI:function(){this.timer.setTime(data.getLevelTime())},levelComplete:function(){this.next=new App.MyButton("nextButton",this.nextClick,this,{x:540,y:125,center:!0,parentGroup:this.uiGroup,wobble:!0}),this.tweenAlphaButton(this.next.bt,0),this.levelTf.visible=!1,this.descTxt=game.add.text(Config.WIDTH/2,42,data.getPaintingDesc(),{font:"bold 22px Arial",fill:"#000000",align:"center"},this.uiGroup),this.descTxt.anchor.set(.5,.5),this.descTxt.alpha=0,game.add.tween(this.descTxt).to({alpha:1},500,Phaser.Easing.Linear.None,!0)},tweenAlphaButton:function(a,b){a.alpha=0,this.add.tween(a).to({alpha:1},500,Phaser.Easing.Linear.None,!0,b)},shutdown:function(){this.logic.destroy()}},App.MainMenuState=function(){},App.MainMenuState.prototype={create:function(){this.add.sprite(0,0,"cuteBack1.jpg"),this.title=new App.GameTitle(Config.WIDTH/2,100),this.playBt=new App.MyButton("playButton",this.playClick,this,{x:400,y:500,center:!0,wobble:!0}),this.soundIcon=new App.SoundIcon({x:80,y:735});var a="v "+Config.VERSION,b=this.add.text(5,Config.HEIGHT-5,a,{font:"12px Arial",fill:"#000000"});b.anchor.set(0,1),App.Fader.SHOULD_FADE_OUT&&fader.fadeOut()},showWithTweens:function(){util.tweenWithAlpha(this.title.group,0),this.tweenScaleButton(this.soundIcon.group,500),this.tweenScaleButton(this.creditsBt.bt,700),this.tweenScaleButton(this.language.group,900),this.tweenScaleButton(this.playBt.bt,1100)},tweenScaleButton:function(a,b){a.scale.x=a.scale.y=0,this.add.tween(a.scale).to({x:1,y:1},500,Phaser.Easing.Back.Out,!0,b)},tweenAlphaButton:function(a,b){a.alpha=0,this.add.tween(a).to({alpha:1},500,Phaser.Easing.Linear.None,!0,b)},playClick:function(){fader.fade(this.startGame,this)},startGame:function(){cmd.gameStart()},creditsClick:function(){new App.CreditsView},update:function(){this.title.update()}},App.PreloaderState=function(){},App.PreloaderState.prototype={preload:function(){this.add.sprite(0,0,"cuteBack1.jpg");var a,b=["fader","blackBack"],c=["sndClick"];for(a=0;a<b.length;a++){var d=-1==b[a].indexOf(".jpg")?b[a]+".png":b[a];this.load.image(b[a],"assets/images/"+d)}for(a=0;a<c.length;a++){var e=c[a]+".mp3",f=c[a]+".ogg";this.load.audio(c[a],["assets/sounds/"+e,"assets/sounds/"+f])}this.load.atlasJSONHash("atlas","assets/images/atlas.png","assets/images/atlas.json"),this.holder=this.game.add.group(),this.preloadBar=this.add.sprite(126,271,"preloadBar",null,this.holder),this.add.sprite(120,264,"preloadBarHolder",null,this.holder),this.progressTxt=this.game.add.text(Config.WIDTH/2,210,"0%",{font:"bold 50px Arial",fill:"#000000"},this.holder),this.progressTxt.anchor.set(.5,0),this.load.setPreloadSprite(this.preloadBar),this.load.onFileComplete.add(this.fileLoaded,this)},fileLoaded:function(a){this.progressTxt.setText(a+"%")},create:function(){if(Config.ANIMATION){var a=this.game.add.tween(this.holder).to({alpha:0,y:this.holder.y+60},400,Phaser.Easing.Linear.None,!0);a.onComplete.addOnce(this.preloaderComplete,this)}else this.preloaderComplete()},preloaderComplete:function(){fader=new App.Fader(this.game),cmd=new App.Commands,data=new App.Data,sounds=new App.Sounds,util=new App.Util,this.game.state.start("MainMenu")}};