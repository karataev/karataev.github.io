function Config(){}var Assets=Class.extend({queue:void 0,callback:void 0,scope:void 0,loaderBar:void 0,percentTf:void 0,init:function(a,b){this.callback=a,this.scope=b,this.preloader=new Preloader,this.queue=new createjs.LoadQueue(!1),createjs.Sound.alternateExtensions=["mp3"],this.queue.installPlugin(createjs.Sound);var c,d=["background","fader","dialogSmall","dialogMedium","dialogBig","blackBack","dragItem","dragItem2","dragItem3","dragItem4","dragItemFixed","dragItemSelection","playButton","playButton2","soundIconOn","soundIconOff","gameTitle","editorButton","creditsButton","levelSelectTitle","homeButton","upButton","downButton","levelItemBack","levelItemCompleteBack","levelItemLockedBack","restartButton","pauseButton","levelUIBack","newRecord","timerIcon","shuffleButton","saveButton","levelCompleteTitle","levelCompleteBack","nextButton","levelsButton","pauseTitle","pauseBox","deleteProgressTitle","clearProgressBox","yesButton","noButton","gameCompleteBox","creditsTitle","creditsBox","closeButton","postepennoLogo","focusLostBox"],e=["sndClick","sndLevelComplete","music"],f=[];for(c=0;c<d.length;c++){var g=-1==d[c].indexOf(".jpg")?d[c]+".png":d[c];f.push({id:d[c],src:"assets/images/"+g})}for(c=0;c<e.length;c++)f.push({id:e[c],src:"assets/sounds/"+e[c]+".ogg"});this.queue.on("fileload",this.onFileLoad,this),this.queue.on("complete",this.onComplete,this),this.queue.loadManifest(f)},get:function(a){return this.queue.getResult(a)},onComplete:function(){createjs.Tween.get(this.preloader.container).to({y:this.preloader.container.y+50,alpha:0},500,createjs.Ease.linear).call(this.preloaderHideComplete,[],this)},preloaderHideComplete:function(){this.preloader.destroy(),this.callback.call(this.scope)},onFileLoad:function(){this.preloader.update(this.queue.progress)}}),LevelStartCommand=Class.extend({init:function(a){game.curLevel=game.getLevelByID(a),createjs.Ticker.init(),game.startTime=createjs.Ticker.getTime(!0),game.levelTime=0,game.levelView=new LevelView(game),Main.addView(game.levelView),game.logic=new GameLogic(game),game.addComponent(game.logic),game.tickerAdd()}}),LevelAbortCommand=Class.extend({init:function(){game.hasComponent(game.logic)&&game.removeComponent(game.logic),Main.removeViewByClass(LevelView),Main.removeViewByClass(LevelCompleteView),Main.removeViewByClass(PauseView),game.tickerRemove()}}),LevelNextCommand=Class.extend({init:function(){var a=game.curLevel.id;new LevelAbortCommand,a==game.levels.length-1?new GameCompleteCommand:new LevelStartCommand(a+1)}}),LevelCompleteCommand=Class.extend({init:function(){game.logic.removeTouchListener(),game.curLevel.complete(game.levelTime),cookies.levelComplete(),game.levelView.levelComplete(),Main.addView(new LevelCompleteView(game)),Sounds.play("sndLevelComplete"),game.tickerRemove()}}),GameCompleteCommand=Class.extend({init:function(){Main.addView(new GameCompleteView(game))}}),Component=Class.extend({init:function(){},destroy:function(){}}),ComponentBox=Class.extend({init:function(){this.components=[]},addComponent:function(a){this.components.push(a)},removeComponent:function(a){var b=this.components.indexOf(a);this.components.splice(b,1),a.destroy()},hasComponent:function(a){return-1===this.components.indexOf(a)?!1:!0},destroyComponents:function(){for(;this.components.length>0;){var a=this.components.pop();a.destroy()}},destroy:function(){this.destroyComponents()}});Config.WIDTH=640,Config.HEIGHT=712,Config.VERSION="0.95",Config.ITEM_GFX_RADIUS=30,Config.ITEM_TOUCH_RADIUS=35,Config.DRAG_BOUNDS={x:0,y:100,width:Config.WIDTH,height:Config.HEIGHT-100},Config.TRANSPARENT=!1,Config.LEVEL_START_ANIMATION=!0,Config.START_LAST_LEVEL=!1,Config.OPEN_ALL_LEVELS=!1,Config.TEST_GAME_COMPLETE=!1,Config.SHOW_FPS=!1,Config.AUTO_RESIZE=!0,Config.RELEASE=!1,Config.RELEASE&&(Config.TRANSPARENT=!1,Config.LEVEL_START_ANIMATION=!0,Config.START_LAST_LEVEL=!1,Config.OPEN_ALL_LEVELS=!1,Config.TEST_GAME_COMPLETE=!1,Config.SHOW_FPS=!1,Config.AUTO_RESIZE=!1);var Cookies=Class.extend({init:function(){this.gameStorageKey="dontcross",this.initSound()},assignGame:function(a){this.game=a,this.isNewGame=!0,this.initLevels()},isSupported:function(){var a="test",b=window.sessionStorage;try{return b.setItem(a,"1"),b.removeItem(a),!0}catch(c){return!1}},getStorage:function(a){return localStorage[this.gameStorageKey+"."+a]},setStorage:function(a,b){this.isSupported()&&(localStorage[this.gameStorageKey+"."+a]=b)},initSound:function(){Sounds.soundEnabled="false"==this.getStorage("soundEnabled")?!1:!0},saveSound:function(){this.setStorage("soundEnabled",Sounds.soundEnabled)},initLevels:function(){if(void 0!=this.getStorage("levels"))for(var a=0;a<this.game.levels.length;a++){var b=this.game.levels[a];if("true"==this.getStorage("levels."+a+".isCompleted")){b.isOpen=!0,b.isCompleted=!0;var c=this.getStorage("levels."+a+".time");void 0!==c&&(b.bestTime=parseInt(c)),this.isNewGame=!1}}this.updateOpenLevels()},updateOpenLevels:function(){var a,b;if(Config.OPEN_ALL_LEVELS)for(a=0;a<this.game.levels.length;a++)b=this.game.levels[a],b.isOpen=!0;else for(a=0;a<this.game.levels.length;a++)if(b=this.game.levels[a],!b.isCompleted){b.isOpen=!0;break}},levelComplete:function(){this.setStorage("levels","true");var a=this.game.curLevel.id;this.setStorage("levels."+a+".isCompleted","true"),this.setStorage("levels."+a+".time",this.game.curLevel.bestTime),this.isNewGame=!1,this.updateOpenLevels()},clear:function(){localStorage.clear(),this.isNewGame=!0,this.uncompleteLevels(),this.updateOpenLevels()},uncompleteLevels:function(){for(var a=0;a<this.game.levels.length;a++){var b=this.game.levels[a];b.reset()}}}),Editor=ComponentBox.extend({init:function(){this._super();var a=0,b={name:"Jail",items:[{id:0,x:225,y:482},{id:1,x:311,y:480},{id:2,x:311,y:390},{id:3,x:392,y:435,fixed:!0},{id:4,x:549,y:622,fixed:!0},{id:5,x:377,y:622},{id:6,x:222,y:622},{id:7,x:81,y:622,fixed:!0},{id:8,x:455,y:527},{id:9,x:387,y:542,fixed:!0},{id:10,x:223,y:391,fixed:!0},{id:11,x:174,y:542,fixed:!0},{id:12,x:81,y:490},{id:13,x:551,y:398},{id:14,x:455,y:398},{id:15,x:392,y:340,fixed:!0},{id:16,x:226,y:306},{id:17,x:81,y:382},{id:18,x:455,y:272},{id:19,x:392,y:258,fixed:!0},{id:20,x:308,y:302},{id:21,x:176,y:256,fixed:!0},{id:22,x:81,y:266},{id:23,x:557,y:173,fixed:!0},{id:24,x:392,y:173},{id:25,x:210,y:173},{id:26,x:81,y:173,fixed:!0}],links:[{p1:13,p2:14},{p1:13,p2:8},{p1:8,p2:4},{p1:8,p2:5},{p1:14,p2:8},{p1:18,p2:13},{p1:23,p2:18},{p1:24,p2:18},{p1:18,p2:14},{p1:2,p2:14},{p1:10,p2:1},{p1:10,p2:20},{p1:10,p2:2},{p1:16,p2:10},{p1:10,p2:0},{p1:1,p2:0},{p1:2,p2:1},{p1:20,p2:2},{p1:16,p2:20},{p1:21,p2:11},{p1:11,p2:9},{p1:3,p2:9},{p1:19,p2:15},{p1:19,p2:21},{p1:25,p2:22},{p1:12,p2:6},{p1:26,p2:22},{p1:22,p2:17},{p1:17,p2:12},{p1:12,p2:7},{p1:7,p2:6},{p1:6,p2:5},{p1:5,p2:4},{p1:13,p2:4},{p1:23,p2:13},{p1:23,p2:24},{p1:24,p2:25},{p1:25,p2:26}]};this.curLevel=new Level(a,b)},levelStart:function(){this.view=new EditorView(this),Main.addView(this.view),this.logic=new GameLogic(this),this.addComponent(this.logic)},levelAbort:function(){this.removeComponent(this.logic),Main.removeViewByClass(EditorView)},shuffleItems:function(){for(var a=this.logic.getItems(),b=0;b<a.length;b++){var c=a[b];if(!c.fixed){var d=Math.floor(Math.random()*Config.WIDTH),e=Math.floor(Math.random()*Config.HEIGHT),f=this.logic.fitInBounds(d,e);c.setPos(f.x,f.y)}}this.logic.checkAllIntersections(),this.logic.renderLinks(),this.logic.renderItems()},saveLevel:function(){var a,b=this.logic.getItems(),c=this.logic.getLinks(),d="items:[ ";for(a=b.length-1;a>=0;a--){var e=b[a],f="",g="id:"+e.id,h="x:"+Math.round(e.getX()),i="y:"+Math.round(e.getY());e.fixed&&(f="fixed:true"),f.length>0&&(f=", "+f);var j="{"+g+", "+h+", "+i+f+"}, ";d+=j}d=d.slice(0,d.length-2),d+=" ]";var k="links:[ ";for(a=c.length-1;a>=0;a--){var l=c[a],m="{p1:"+l.p1.id+", p2:"+l.p2.id+"}, ";k+=m}k=k.slice(0,k.length-2),k+=" ]";var n="name:'"+this.curLevel.getTitle()+"'",o="{"+n+", "+d+", "+k+"}";this.copyToClipboard(o)},copyToClipboard:function(a){window.prompt("Copy to clipboard: Ctrl+C, Enter",a)},levelComplete:function(){}}),FocusManager=Class.extend({init:function(){this.FOCUS=!0,$(window).on("blur",$.proxy(this.onBlur,this))},onBlur:function(){this.FOCUS&&(this.FOCUS=!1,Sounds.stopMusic(),Main.addView(new FocusLostView(Main.topContainer,game)))},resume:function(){0==this.FOCUS&&(this.FOCUS=!0,Sounds.startMusic())}}),Game=ComponentBox.extend({init:function(){this._super(),this.createLevels()},loadProgress:function(){console.log("first"),console.log(localStorage["game.version"]),console.log("second")},createLevels:function(){this.levels=[],this.addLevel({name:"Krest",items:[{id:0,x:126,y:225},{id:1,x:126,y:533},{id:2,x:488,y:533},{id:3,x:488,y:224}],links:[{p1:3,p2:1},{p1:0,p2:2}]}),this.addLevel({name:"Snowflake",items:[{id:0,x:505,y:244},{id:1,x:156,y:568},{id:2,x:90,y:403},{id:3,x:332,y:165},{id:4,x:510,y:557},{id:5,x:566,y:400},{id:6,x:332,y:641},{id:7,x:161,y:233}],links:[{p1:0,p2:1},{p1:7,p2:4},{p1:2,p2:5},{p1:3,p2:6}]}),this.addLevel({name:"Snake",items:[{id:0,x:285,y:402},{id:1,x:285,y:619},{id:2,x:286,y:173},{id:3,x:489,y:620},{id:4,x:489,y:400},{id:5,x:131,y:506},{id:6,x:477,y:159},{id:7,x:132,y:286}],links:[{p1:0,p2:1},{p1:2,p2:0},{p1:6,p2:7},{p1:7,p2:4},{p1:5,p2:4},{p1:5,p2:3}]}),this.addLevel({name:"Two quads",items:[{id:0,x:140,y:209},{id:1,x:475,y:616},{id:2,x:475,y:416},{id:3,x:134,y:616},{id:4,x:475,y:207},{id:5,x:141,y:416}],links:[{p1:3,p2:2},{p1:5,p2:1},{p1:4,p2:5},{p1:0,p2:2},{p1:5,p2:2},{p1:0,p2:5},{p1:5,p2:3},{p1:3,p2:1},{p1:2,p2:1},{p1:4,p2:2},{p1:4,p2:0}]}),this.addLevel({name:"Straight Circle",items:[{id:0,x:497,y:226},{id:1,x:133,y:577},{id:2,x:68,y:407},{id:3,x:324,y:154},{id:4,x:504,y:582},{id:5,x:574,y:404},{id:6,x:323,y:660},{id:7,x:140,y:230}],links:[{p1:3,p2:4},{p1:2,p2:4},{p1:0,p2:2},{p1:0,p2:6},{p1:7,p2:6},{p1:7,p2:5},{p1:1,p2:5},{p1:3,p2:1}]}),this.addLevel({name:"Snowflake2",items:[{id:0,x:324,y:407},{id:1,x:497,y:226},{id:2,x:133,y:577},{id:3,x:68,y:407},{id:4,x:324,y:154},{id:5,x:504,y:582},{id:6,x:574,y:404},{id:7,x:323,y:660},{id:8,x:140,y:230}],links:[{p1:2,p2:6},{p1:8,p2:6},{p1:8,p2:7},{p1:1,p2:7},{p1:1,p2:3},{p1:3,p2:5},{p1:4,p2:5},{p1:4,p2:2},{p1:0,p2:7},{p1:4,p2:0},{p1:0,p2:6},{p1:0,p2:3}]}),this.addLevel({name:"Snowflake3",items:[{id:0,x:497,y:226},{id:1,x:133,y:577},{id:2,x:68,y:407},{id:3,x:324,y:154},{id:4,x:504,y:582},{id:5,x:574,y:404},{id:6,x:323,y:660},{id:7,x:140,y:230}],links:[{p1:0,p2:1},{p1:2,p2:5},{p1:7,p2:4},{p1:3,p2:6},{p1:3,p2:7},{p1:7,p2:2},{p1:2,p2:1},{p1:1,p2:6},{p1:6,p2:4},{p1:5,p2:4},{p1:0,p2:5}]}),this.addLevel({name:"Fixed Intro",items:[{id:0,x:460,y:549,fixed:!0},{id:1,x:194,y:549,fixed:!0},{id:2,x:460,y:281,fixed:!0},{id:3,x:194,y:281,fixed:!0},{id:4,x:326,y:407,fixed:!0},{id:5,x:68,y:407},{id:6,x:324,y:154},{id:7,x:574,y:404},{id:8,x:323,y:660}],links:[{p1:3,p2:1},{p1:2,p2:3},{p1:2,p2:0},{p1:1,p2:0},{p1:8,p2:4},{p1:6,p2:4},{p1:5,p2:4},{p1:7,p2:4}]}),this.addLevel({name:"Quad in quad",items:[{id:0,x:393,y:487},{id:1,x:237,y:488},{id:2,x:175,y:581,fixed:!0},{id:3,x:454,y:581,fixed:!0},{id:4,x:454,y:238,fixed:!0},{id:5,x:173,y:240,fixed:!0},{id:6,x:391,y:319},{id:7,x:237,y:319},{id:8,x:308,y:647,fixed:!0},{id:9,x:525,y:393,fixed:!0},{id:10,x:86,y:394,fixed:!0},{id:11,x:308,y:162,fixed:!0}],links:[{p1:6,p2:9},{p1:9,p2:0},{p1:10,p2:1},{p1:10,p2:7},{p1:6,p2:11},{p1:11,p2:7},{p1:8,p2:0},{p1:1,p2:8},{p1:7,p2:1},{p1:6,p2:7},{p1:6,p2:0},{p1:1,p2:0},{p1:2,p2:3},{p1:5,p2:2},{p1:4,p2:5},{p1:4,p2:3}]}),this.addLevel({name:"Periscope",items:[{id:0,x:571,y:536,fixed:!0},{id:1,x:488,y:493,fixed:!0},{id:2,x:405,y:533,fixed:!0},{id:3,x:323,y:552,fixed:!0},{id:4,x:240,y:536,fixed:!0},{id:5,x:157,y:499,fixed:!0},{id:6,x:75,y:538,fixed:!0},{id:7,x:454,y:670,fixed:!0},{id:8,x:373,y:671,fixed:!0},{id:9,x:371,y:309},{id:10,x:453,y:213},{id:11,x:251,y:307},{id:12,x:247,y:217},{id:13,x:174,y:378},{id:14,x:165,y:174},{id:15,x:84,y:377},{id:16,x:84,y:175},{id:17,x:653,y:545,fixed:!0},{id:18,x:-20,y:549,fixed:!0}],links:[{p1:12,p2:11},{p1:6,p2:18},{p1:6,p2:5},{p1:4,p2:5},{p1:4,p2:3},{p1:3,p2:2},{p1:1,p2:2},{p1:1,p2:0},{p1:17,p2:0},{p1:7,p2:8},{p1:10,p2:7},{p1:10,p2:12},{p1:14,p2:12},{p1:14,p2:16},{p1:16,p2:15},{p1:15,p2:13},{p1:13,p2:11},{p1:9,p2:11},{p1:9,p2:8}]}),this.addLevel({name:"Spikes",items:[{id:0,x:557,y:162,fixed:!0},{id:1,x:-28,y:576,fixed:!0},{id:2,x:464,y:576,fixed:!0},{id:3,x:307,y:470,fixed:!0},{id:4,x:676,y:471,fixed:!0},{id:5,x:461,y:162},{id:6,x:203,y:162},{id:7,x:-30,y:349,fixed:!0},{id:8,x:289,y:162},{id:9,x:375,y:162},{id:10,x:307,y:243,fixed:!0},{id:11,x:674,y:243,fixed:!0},{id:12,x:463,y:349,fixed:!0},{id:13,x:80,y:649,fixed:!0}],links:[{p1:12,p2:7},{p1:6,p2:13},{p1:6,p2:8},{p1:9,p2:8},{p1:9,p2:5},{p1:0,p2:5},{p1:4,p2:3},{p1:2,p2:1},{p1:11,p2:10}]}),this.addLevel({name:"X",items:[{id:0,x:211,y:491,fixed:!0},{id:1,x:396,y:489},{id:2,x:396,y:286,fixed:!0},{id:3,x:214,y:288},{id:4,x:296,y:374},{id:5,x:500,y:374,fixed:!0},{id:6,x:121,y:376,fixed:!0},{id:7,x:295,y:217,fixed:!0},{id:8,x:296,y:583,fixed:!0}],links:[{p1:3,p2:0},{p1:2,p2:3},{p1:2,p2:1},{p1:0,p2:1},{p1:4,p2:8},{p1:7,p2:4},{p1:6,p2:4},{p1:5,p2:4}]}),this.addLevel({name:"Line12Dots",items:[{id:0,x:599,y:450},{id:1,x:227,y:283},{id:2,x:172,y:625},{id:3,x:583,y:318},{id:4,x:544,y:559},{id:5,x:498,y:178},{id:6,x:82,y:490},{id:7,x:248,y:130},{id:8,x:298,y:428},{id:9,x:72,y:243},{id:10,x:393,y:624},{id:11,x:313,y:213}],links:[{p1:1,p2:0},{p1:2,p2:1},{p1:3,p2:2},{p1:7,p2:3},{p1:6,p2:7},{p1:6,p2:5},{p1:4,p2:5},{p1:8,p2:4},{p1:9,p2:8},{p1:9,p2:10},{p1:11,p2:10}]}),this.addLevel({name:"TwoLines",items:[{id:0,x:318,y:285},{id:1,x:109,y:570},{id:2,x:221,y:130},{id:3,x:378,y:510},{id:4,x:276,y:476},{id:5,x:602,y:142},{id:6,x:214,y:457},{id:7,x:517,y:142},{id:8,x:588,y:320},{id:9,x:464,y:464},{id:10,x:66,y:232},{id:11,x:191,y:365},{id:12,x:562,y:255},{id:13,x:146,y:674},{id:14,x:554,y:559},{id:15,x:433,y:170},{id:16,x:461,y:537},{id:17,x:276,y:597},{id:18,x:133,y:171},{id:19,x:330,y:213},{id:20,x:493,y:658},{id:21,x:55,y:429},{id:22,x:568,y:425},{id:23,x:345,y:144}],links:[{p1:0,p2:1},{p1:1,p2:2},{p1:2,p2:3},{p1:7,p2:3},{p1:7,p2:6},{p1:6,p2:5},{p1:5,p2:4},{p1:8,p2:4},{p1:9,p2:8},{p1:10,p2:9},{p1:11,p2:10},{p1:12,p2:13},{p1:14,p2:13},{p1:14,p2:15},{p1:19,p2:15},{p1:19,p2:18},{p1:17,p2:18},{p1:17,p2:16},{p1:20,p2:16},{p1:21,p2:20},{p1:21,p2:22},{p1:23,p2:22}]}),this.addLevel({name:"FourQuads",items:[{id:0,x:220,y:495},{id:1,x:175,y:208},{id:2,x:536,y:367},{id:3,x:333,y:150},{id:4,x:42,y:575},{id:5,x:513,y:190},{id:6,x:60,y:436},{id:7,x:385,y:661},{id:8,x:235,y:266},{id:9,x:508,y:469},{id:10,x:159,y:650},{id:11,x:314,y:520},{id:12,x:412,y:475},{id:13,x:434,y:320},{id:14,x:458,y:575},{id:15,x:96,y:271}],links:[{p1:7,p2:3},{p1:6,p2:2},{p1:5,p2:1},{p1:4,p2:0},{p1:0,p2:1},{p1:2,p2:3},{p1:12,p2:8},{p1:13,p2:9},{p1:14,p2:10},{p1:15,p2:11},{p1:5,p2:4},{p1:7,p2:6},{p1:10,p2:11},{p1:8,p2:9},{p1:13,p2:12},{p1:15,p2:14}]}),this.addLevel({name:"9Quads",items:[{id:0,x:125,y:206},{id:1,x:475,y:398},{id:2,x:534,y:652},{id:3,x:261,y:321},{id:4,x:498,y:292},{id:5,x:269,y:166},{id:6,x:120,y:394},{id:7,x:554,y:502},{id:8,x:129,y:533},{id:9,x:387,y:625},{id:10,x:256,y:391},{id:11,x:289,y:543},{id:12,x:306,y:642},{id:13,x:437,y:198},{id:14,x:188,y:654},{id:15,x:179,y:287}],links:[{p1:1,p2:2},{p1:11,p2:7},{p1:6,p2:5},{p1:10,p2:6},{p1:8,p2:4},{p1:9,p2:5},{p1:10,p2:9},{p1:13,p2:14},{p1:7,p2:3},{p1:6,p2:2},{p1:5,p2:1},{p1:4,p2:0},{p1:0,p2:1},{p1:2,p2:3},{p1:12,p2:8},{p1:13,p2:9},{p1:14,p2:10},{p1:15,p2:11},{p1:5,p2:4},{p1:7,p2:6},{p1:10,p2:11},{p1:8,p2:9},{p1:13,p2:12},{p1:15,p2:14}]}),this.addLevel({name:"Quad quad",items:[{id:0,x:354,y:639},{id:1,x:556,y:639},{id:2,x:554,y:453},{id:3,x:360,y:447},{id:4,x:77,y:639},{id:5,x:259,y:639},{id:6,x:268,y:450},{id:7,x:81,y:453},{id:8,x:357,y:368},{id:9,x:554,y:369},{id:10,x:559,y:182},{id:11,x:355,y:182},{id:12,x:81,y:371},{id:13,x:268,y:371},{id:14,x:264,y:184},{id:15,x:78,y:180},{id:16,x:173,y:556},{id:17,x:457,y:556},{id:18,x:457,y:272},{id:19,x:180,y:272}],links:[{p1:8,p2:6},{p1:13,p2:3},{p1:19,p2:16},{p1:16,p2:17},{p1:18,p2:17},{p1:18,p2:19},{p1:3,p2:0},{p1:0,p2:1},{p1:2,p2:1},{p1:2,p2:3},{p1:7,p2:4},{p1:4,p2:5},{p1:6,p2:5},{p1:6,p2:7},{p1:10,p2:11},{p1:10,p2:9},{p1:8,p2:9},{p1:11,p2:8},{p1:12,p2:13},{p1:14,p2:13},{p1:14,p2:15},{p1:15,p2:12}]}),this.addLevel({name:"Diagonal",items:[{id:0,x:392,y:464,fixed:!0},{id:1,x:84,y:614},{id:2,x:71,y:237},{id:3,x:399,y:649},{id:4,x:313,y:491},{id:5,x:283,y:158},{id:6,x:480,y:548,fixed:!0},{id:7,x:308,y:388,fixed:!0},{id:8,x:448,y:392},{id:9,x:243,y:660},{id:10,x:229,y:317,fixed:!0},{id:11,x:153,y:246,fixed:!0},{id:12,x:487,y:187},{id:13,x:526,y:383},{id:14,x:138,y:169},{id:15,x:30,y:461},{id:16,x:172,y:501}],links:[{p1:6,p2:2},{p1:5,p2:6},{p1:3,p2:0},{p1:9,p2:0},{p1:7,p2:4},{p1:13,p2:7},{p1:10,p2:8},{p1:14,p2:10},{p1:11,p2:12},{p1:15,p2:11},{p1:6,p2:1},{p1:0,p2:6},{p1:7,p2:0},{p1:10,p2:7},{p1:11,p2:10},{p1:16,p2:11},{p1:16,p2:12},{p1:12,p2:8},{p1:8,p2:4},{p1:4,p2:3},{p1:3,p2:2},{p1:2,p2:1},{p1:5,p2:1},{p1:9,p2:5},{p1:13,p2:9},{p1:13,p2:14},{p1:14,p2:15},{p1:15,p2:16}]}),this.addLevel({name:"Minefield",items:[{id:0,x:534,y:514},{id:1,x:452,y:207},{id:2,x:135,y:292},{id:3,x:565,y:401,fixed:!0},{id:4,x:564,y:640,fixed:!0},{id:5,x:320,y:638,fixed:!0},{id:6,x:77,y:640,fixed:!0},{id:7,x:73,y:401,fixed:!0},{id:8,x:76,y:161,fixed:!0},{id:9,x:565,y:161,fixed:!0},{id:10,x:320,y:161,fixed:!0},{id:11,x:215,y:606},{id:12,x:324,y:401,fixed:!0}],links:[{p1:1,p2:2},{p1:11,p2:2},{p1:11,p2:0},{p1:0,p2:1},{p1:1,p2:7},{p1:0,p2:7},{p1:10,p2:0},{p1:11,p2:10},{p1:11,p2:3},{p1:3,p2:2},{p1:5,p2:2},{p1:1,p2:5},{p1:1,p2:6},{p1:9,p2:11},{p1:8,p2:0},{p1:2,p2:4},{p1:12,p2:2},{p1:12,p2:1},{p1:12,p2:0},{p1:11,p2:12}]}),this.addLevel({name:"9HardQuads",items:[{id:0,x:583,y:281},{id:1,x:278,y:171},{id:2,x:49,y:540},{id:3,x:429,y:361},{id:4,x:176,y:371},{id:5,x:523,y:623},{id:6,x:511,y:461},{id:7,x:338,y:376},{id:8,x:279,y:482},{id:9,x:67,y:226},{id:10,x:443,y:269},{id:11,x:604,y:559},{id:12,x:122,y:157},{id:13,x:229,y:622},{id:14,x:270,y:303},{id:15,x:462,y:161}],links:[{p1:5,p2:0},{p1:5,p2:2},{p1:7,p2:2},{p1:10,p2:7},{p1:10,p2:5},{p1:8,p2:5},{p1:13,p2:8},{p1:13,p2:10},{p1:15,p2:10},{p1:1,p2:2},{p1:11,p2:7},{p1:6,p2:5},{p1:10,p2:6},{p1:8,p2:4},{p1:9,p2:5},{p1:10,p2:9},{p1:13,p2:14},{p1:7,p2:3},{p1:6,p2:2},{p1:5,p2:1},{p1:4,p2:0},{p1:0,p2:1},{p1:2,p2:3},{p1:12,p2:8},{p1:13,p2:9},{p1:14,p2:10},{p1:15,p2:11},{p1:5,p2:4},{p1:7,p2:6},{p1:10,p2:11},{p1:8,p2:9},{p1:13,p2:12},{p1:15,p2:14}]}),this.addLevel({name:"StaticQuad",items:[{id:0,x:495,y:292},{id:1,x:198,y:332},{id:2,x:550,y:369},{id:3,x:81,y:268},{id:4,x:506,y:544},{id:5,x:407,y:469,fixed:!0},{id:6,x:250,y:469,fixed:!0},{id:7,x:520,y:180},{id:8,x:251,y:649},{id:9,x:407,y:327,fixed:!0},{id:10,x:250,y:327,fixed:!0},{id:11,x:117,y:634},{id:12,x:89,y:500},{id:13,x:460,y:644},{id:14,x:302,y:259},{id:15,x:200,y:141}],links:[{p1:10,p2:7},{p1:6,p2:3},{p1:2,p2:5},{p1:5,p2:0},{p1:9,p2:4},{p1:12,p2:9},{p1:13,p2:10},{p1:15,p2:10},{p1:11,p2:10},{p1:6,p2:7},{p1:6,p2:2},{p1:5,p2:1},{p1:4,p2:5},{p1:9,p2:8},{p1:13,p2:9},{p1:14,p2:10},{p1:10,p2:6},{p1:6,p2:5},{p1:9,p2:5},{p1:9,p2:10},{p1:15,p2:11},{p1:11,p2:7},{p1:7,p2:3},{p1:3,p2:2},{p1:2,p2:1},{p1:1,p2:0},{p1:4,p2:0},{p1:8,p2:4},{p1:12,p2:8},{p1:12,p2:13},{p1:13,p2:14},{p1:14,p2:15}]}),this.addLevel({name:"Matreshka",items:[{id:0,x:539,y:433},{id:1,x:442,y:203},{id:2,x:93,y:395},{id:3,x:91,y:238},{id:4,x:545,y:534},{id:5,x:205,y:134},{id:6,x:77,y:647,fixed:!0},{id:7,x:547,y:130},{id:8,x:409,y:669},{id:9,x:380,y:136},{id:10,x:562,y:177,fixed:!0},{id:11,x:167,y:442},{id:12,x:437,y:339},{id:13,x:601,y:303},{id:14,x:350,y:464},{id:15,x:314,y:670},{id:16,x:260,y:512},{id:17,x:463,y:532,fixed:!0},{id:18,x:162,y:624},{id:19,x:586,y:635},{id:20,x:73,y:523},{id:21,x:180,y:289,fixed:!0},{id:22,x:258,y:441,fixed:!0},{id:23,x:228,y:215},{id:24,x:346,y:358,fixed:!0},{id:25,x:345,y:216}],links:[{p1:25,p2:22},{p1:22,p2:23},{p1:24,p2:23},{p1:24,p2:25},{p1:21,p2:14},{p1:14,p2:15},{p1:15,p2:16},{p1:16,p2:17},{p1:18,p2:17},{p1:19,p2:18},{p1:19,p2:20},{p1:20,p2:21},{p1:5,p2:6},{p1:4,p2:5},{p1:3,p2:4},{p1:13,p2:3},{p1:12,p2:13},{p1:11,p2:12},{p1:10,p2:11},{p1:10,p2:0},{p1:0,p2:1},{p1:1,p2:2},{p1:2,p2:9},{p1:8,p2:9},{p1:7,p2:8},{p1:6,p2:7}]}),this.addLevel({name:"SnakeFixed",items:[{id:0,x:355,y:389,fixed:!0},{id:1,x:-34,y:525,fixed:!0},{id:2,x:352,y:579,fixed:!0},{id:3,x:265,y:593,fixed:!0},{id:4,x:170,y:650},{id:5,x:388,y:516},{id:6,x:191,y:463},{id:7,x:367,y:657},{id:8,x:574,y:540},{id:9,x:252,y:405},{id:10,x:437,y:402},{id:11,x:273,y:135},{id:12,x:477,y:224},{id:13,x:517,y:661},{id:14,x:142,y:374},{id:15,x:240,y:197},{id:16,x:174,y:423,fixed:!0},{id:17,x:541,y:135},{id:18,x:104,y:309},{id:19,x:202,y:536},{id:20,x:50,y:392},{id:21,x:195,y:340,fixed:!0},{id:22,x:571,y:377},{id:23,x:172,y:259,fixed:!0},{id:24,x:666,y:305,fixed:!0},{id:25,x:470,y:523,fixed:!0},{id:26,x:470,y:741,fixed:!0},{id:27,x:584,y:166,fixed:!0},{id:28,x:121,y:183},{id:29,x:302,y:348},{id:30,x:48,y:645,fixed:!0}],links:[{p1:18,p2:30},{p1:18,p2:17},{p1:29,p2:17},{p1:29,p2:28},{p1:22,p2:28},{p1:15,p2:22},{p1:14,p2:15},{p1:13,p2:14},{p1:12,p2:13},{p1:11,p2:12},{p1:11,p2:10},{p1:10,p2:9},{p1:9,p2:8},{p1:7,p2:8},{p1:6,p2:7},{p1:5,p2:6},{p1:4,p2:5},{p1:4,p2:20},{p1:19,p2:20},{p1:27,p2:19},{p1:0,p2:3},{p1:25,p2:26},{p1:3,p2:2},{p1:3,p2:1},{p1:21,p2:16},{p1:23,p2:21},{p1:24,p2:23}]}),this.addLevel({name:"Grid",items:[{id:0,x:508,y:526,fixed:!0},{id:1,x:508,y:400},{id:2,x:508,y:292,fixed:!0},{id:3,x:120,y:526},{id:4,x:120,y:400,fixed:!0},{id:5,x:120,y:292},{id:6,x:200,y:599},{id:7,x:423,y:601},{id:8,x:319,y:601,fixed:!0},{id:9,x:200,y:195,fixed:!0},{id:10,x:424,y:195},{id:11,x:318,y:195}],links:[{p1:8,p2:6},{p1:8,p2:7},{p1:1,p2:0},{p1:2,p2:1},{p1:10,p2:11},{p1:9,p2:11},{p1:4,p2:3},{p1:5,p2:4},{p1:3,p2:0},{p1:4,p2:1},{p1:2,p2:5},{p1:10,p2:7},{p1:11,p2:8},{p1:9,p2:6}]}),this.addLevel({name:"Fixed X",items:[{id:0,x:315,y:493},{id:1,x:172,y:672},{id:2,x:585,y:410},{id:3,x:584,y:545},{id:4,x:503,y:486},{id:5,x:566,y:165},{id:6,x:36,y:441},{id:7,x:110,y:249},{id:8,x:559,y:295},{id:9,x:215,y:167},{id:10,x:41,y:314},{id:11,x:240,y:566},{id:12,x:569,y:632,fixed:!0},{id:13,x:69,y:630,fixed:!0},{id:14,x:68,y:163,fixed:!0},{id:15,x:573,y:158,fixed:!0},{id:16,x:320,y:148},{id:17,x:398,y:638},{id:18,x:395,y:246},{id:19,x:157,y:323},{id:20,x:321,y:399,fixed:!0},{id:21,x:195,y:515,fixed:!0},{id:22,x:447,y:516,fixed:!0},{id:23,x:448,y:279,fixed:!0},{id:24,x:195,y:282,fixed:!0}],links:[{p1:20,p2:21},{p1:21,p2:13},{p1:11,p2:17},{p1:16,p2:8},{p1:5,p2:18},{p1:19,p2:2},{p1:15,p2:23},{p1:23,p2:20},{p1:20,p2:17},{p1:20,p2:16},{p1:20,p2:5},{p1:2,p2:20},{p1:24,p2:5},{p1:5,p2:21},{p1:21,p2:16},{p1:16,p2:22},{p1:17,p2:22},{p1:23,p2:17},{p1:23,p2:2},{p1:2,p2:24},{p1:22,p2:12},{p1:20,p2:22},{p1:24,p2:20},{p1:14,p2:24},{p1:1,p2:14},{p1:1,p2:19},{p1:0,p2:19},{p1:15,p2:0},{p1:15,p2:10},{p1:10,p2:11},{p1:11,p2:9},{p1:9,p2:12},{p1:6,p2:12},{p1:8,p2:6},{p1:8,p2:7},{p1:13,p2:7},{p1:3,p2:13},{p1:18,p2:3},{p1:4,p2:18},{p1:14,p2:4}]}),this.addLevel({name:"GridFixed",items:[{id:0,x:500,y:300},{id:1,x:80,y:294},{id:2,x:449,y:158},{id:3,x:230,y:674},{id:4,x:241,y:363},{id:5,x:561,y:493},{id:6,x:536,y:671,fixed:!0},{id:7,x:320,y:733,fixed:!0},{id:8,x:539,y:601},{id:9,x:63,y:648,fixed:!0},{id:10,x:89,y:564},{id:11,x:320,y:515,fixed:!0},{id:12,x:146,y:216},{id:13,x:408,y:403},{id:14,x:576,y:195},{id:15,x:363,y:673},{id:16,x:194,y:416,fixed:!0},{id:17,x:-24,y:416,fixed:!0},{id:18,x:665,y:333,fixed:!0},{id:19,x:431,y:333,fixed:!0},{id:20,x:595,y:292},{id:21,x:62,y:468},{id:22,x:128,y:483},{id:23,x:591,y:403},{id:24,x:281,y:275,fixed:!0},{id:25,x:353,y:140},{id:26,x:543,y:156,fixed:!0},{id:27,x:366,y:483},{id:28,x:281,y:75,fixed:!0},{id:29,x:60,y:157,fixed:!0}],links:[{p1:18,p2:19},{p1:3,p2:25},{p1:3,p2:2},{p1:20,p2:3},{p1:29,p2:20},{p1:29,p2:25},{p1:25,p2:21},{p1:21,p2:2},{p1:2,p2:1},{p1:26,p2:27},{p1:26,p2:22},{p1:23,p2:22},{p1:27,p2:23},{p1:23,p2:1},{p1:22,p2:1},{p1:27,p2:1},{p1:1,p2:0},{p1:8,p2:0},{p1:12,p2:0},{p1:13,p2:0},{p1:13,p2:9},{p1:9,p2:8},{p1:12,p2:8},{p1:12,p2:13},{p1:28,p2:24},{p1:16,p2:17},{p1:11,p2:7},{p1:14,p2:0},{p1:0,p2:5},{p1:10,p2:5},{p1:15,p2:5},{p1:5,p2:4},{p1:4,p2:6},{p1:10,p2:6},{p1:14,p2:10},{p1:14,p2:15},{p1:0,p2:15}]}),this.addLevel({name:"Jail",items:[{id:0,x:568,y:521},{id:1,x:451,y:430},{id:2,x:287,y:207},{id:3,x:392,y:435,fixed:!0},{id:4,x:549,y:622,fixed:!0},{id:5,x:459,y:192},{id:6,x:567,y:417},{id:7,x:81,y:622,fixed:!0},{id:8,x:81,y:459},{id:9,x:387,y:542,fixed:!0},{id:10,x:223,y:391,fixed:!0},{id:11,x:174,y:542,fixed:!0},{id:12,x:126,y:326},{id:13,x:249,y:466},{id:14,x:415,y:663},{id:15,x:392,y:340,fixed:!0},{id:16,x:217,y:132},{id:17,x:148,y:655},{id:18,x:459,y:527},{id:19,x:392,y:258,fixed:!0},{id:20,x:577,y:313},{id:21,x:176,y:256,fixed:!0},{id:22,x:279,y:329},{id:23,x:557,y:173,fixed:!0},{id:24,x:260,y:624},{id:25,x:385,y:159},{id:26,x:81,y:173,fixed:!0}],links:[{p1:13,p2:14},{p1:13,p2:8},{p1:8,p2:4},{p1:8,p2:5},{p1:14,p2:8},{p1:18,p2:13},{p1:23,p2:18},{p1:24,p2:18},{p1:18,p2:14},{p1:2,p2:14},{p1:10,p2:1},{p1:10,p2:20},{p1:10,p2:2},{p1:16,p2:10},{p1:10,p2:0},{p1:1,p2:0},{p1:2,p2:1},{p1:20,p2:2},{p1:16,p2:20},{p1:21,p2:11},{p1:11,p2:9},{p1:3,p2:9},{p1:19,p2:15},{p1:19,p2:21},{p1:25,p2:22},{p1:12,p2:6},{p1:26,p2:22},{p1:22,p2:17},{p1:17,p2:12},{p1:12,p2:7},{p1:7,p2:6},{p1:6,p2:5},{p1:5,p2:4},{p1:13,p2:4},{p1:23,p2:13},{p1:23,p2:24},{p1:24,p2:25},{p1:25,p2:26}]}),this.curLevel=void 0},addLevel:function(a){var b=this.levels.length,c=new Level(b,a);this.levels.push(c)},tickerAdd:function(){this.tickRef=createjs.Ticker.on("tick",this.tick,this)},tickerRemove:function(){createjs.Ticker.off("tick",this.tickRef)},tick:function(){this.levelTime=Math.floor(createjs.Ticker.getTime(!0)-this.startTime),this.levelView.update()},getLevelByID:function(a){return this.levels[a]},getTotalTime:function(){for(var a=0,b=0;b<this.levels.length;b++){var c=this.levels[b];c.isCompleted&&(a+=c.bestTime)}return a},tickerPause:function(){createjs.Ticker.setPaused(!0)},tickerResume:function(){createjs.Ticker.setPaused(!1)}}),GameLogic=ComponentBox.extend({init:function(a){this.game=a,this._super();var b=this.game.curLevel.data;this.linksContainer=new createjs.Container,Main.viewContainer.addChild(this.linksContainer),this.itemsContainer=new createjs.Container,Main.viewContainer.addChild(this.itemsContainer),this.parseLevel(b),this.checkAllIntersections(),this.offset={x:0,y:0},this.back=Main.backContainer,this.activeItem=void 0,this.connectItemsWithLinks(),this.renderLinks(),this.renderItems(),this.levelAppear=new LevelAppear(this,this.appearComplete,this),this.addComponent(this.levelAppear),this.back.addEventListener("mousedown",this)},appearComplete:function(){this.removeComponent(this.levelAppear)},connectItemsWithLinks:function(){for(var a=this.getLinks(),b=this.getItems(),c=0;c<b.length;c++){var d=b[c];d.saveLinks(a)}},handleEvent:function(a){switch(a.type){case"mousedown":this.doMouseDown();break;case"pressup":this.doMouseUp();break;case"pressmove":this.doMouseMove()}},doMouseDown:function(){this.hasComponent(this.levelAppear)&&this.levelAppear.stopAndComplete();var a=stage.mouseX/stage.scaleX,b=stage.mouseY/stage.scaleY,c=this.getUnfixedItemUnderPoint(a,b);c&&(this.offset.x=a-c.getX(),this.offset.y=b-c.getY(),this.back.addEventListener("pressup",this),this.back.addEventListener("pressmove",this),this.activeItem=c,this.activeItem.select())},doMouseMove:function(){var a=stage.mouseX/stage.scaleX-this.offset.x,b=stage.mouseY/stage.scaleY-this.offset.y,c=this.fitInBounds(a,b);this.activeItem.setPos(c.x,c.y),this.checkAllIntersections(),this.renderLinks(),this.renderItems()},doMouseUp:function(){this.back.removeEventListener("pressup",this),this.back.removeEventListener("pressmove",this),this.activeItem.deselect(),this.activeItem=void 0,this.checkAllIntersections(!0)},fitInBounds:function(a,b){var c=Config.ITEM_GFX_RADIUS,d=Config.DRAG_BOUNDS.x,e=Config.DRAG_BOUNDS.y,f=Config.DRAG_BOUNDS.width,g=Config.DRAG_BOUNDS.height;return d+c>a&&(a=d+c),a>d+f-c&&(a=d+f-c),e+c>b&&(b=e+c),b>e+g-c&&(b=e+g-c),{x:a,y:b}},getUnfixedItemUnderPoint:function(a,b){for(var c=Config.ITEM_TOUCH_RADIUS,d=c,e=void 0,f=0;f<this.components.length;f++){var g=this.components[f];if(g instanceof DragItem&&!g.fixed){var h=a-g.getX(),i=b-g.getY(),j=Math.sqrt(h*h+i*i);d>=j&&(d=j,e=g)}}return e},parseLevel:function(a){var b,c=a.items,d=a.links;if(a.items)for(b=0;b<c.length;b++){var e=c[b],f=e.id,g=c[b].x,h=c[b].y,i=!1;void 0!=c[b].fixed&&(i=c[b].fixed);var j=new DragItem(this.game,this.itemsContainer,this,f,{x:g,y:h,fixed:i});this.addComponent(j)}if(a.links)for(b=0;b<d.length;b++){var k=this.getItemById(d[b].p1),l=this.getItemById(d[b].p2),m=new DragLink(this.game,this.linksContainer,k,l);this.addComponent(m)}},getItemById:function(a){for(var b=0;b<this.components.length;b++){var c=this.components[b];if(c instanceof DragItem&&c.id===a)return c}return void 0},renderLinks:function(){for(var a=this.components.length-1;a>=0;a--){var b=this.components[a];b instanceof DragLink&&b.render()}},renderItems:function(){for(var a=this.components.length-1;a>=0;a--){var b=this.components[a];b instanceof DragItem&&b.render()}},setLinksState:function(a){for(var b=this.components.length-1;b>=0;b--){var c=this.components[b];c instanceof DragLink&&c.setState(a)}},checkAllIntersections:function(a){this.setLinksState(DragLink.STATE_NON_INTERSECT);for(var b=!1,c=this.getLinks(),d=0;d<c.length;d++)for(var e=c[d],f=d+1;f<c.length;f++){var g=c[f];this.linkVsLink(e,g)&&(b=!0,e.setState(DragLink.STATE_INTERSECT),g.setState(DragLink.STATE_INTERSECT))}a===!0&&(b||new LevelCompleteCommand)},removeTouchListener:function(){this.back.removeEventListener("mousedown",this)},linkVsLink:function(a,b){var c=a.p1.id,d=a.p2.id,e=b.p1.id,f=b.p2.id;if(c==e||c==f||d==e||d==f)return!1;var g=a.p1.getX(),h=a.p2.getX(),i=b.p1.getX(),j=b.p2.getX(),k=a.p1.getY(),l=a.p2.getY(),m=b.p1.getY(),n=b.p2.getY();if(Math.max(g,h)<Math.min(i,j)||Math.max(i,j)<Math.min(g,h))return!1;if(Math.max(k,l)<Math.min(m,n)||Math.max(m,n)<Math.min(k,l))return!1;var o=(j-i)*(k-m)-(n-m)*(g-i),p=(h-g)*(k-m)-(l-k)*(g-i),q=(n-m)*(h-g)-(j-i)*(l-k);return Math.abs(q)<.001?!1:(o/=q,p/=q,o>0&&1>o&&p>0&&1>p?!0:!1)},getLinks:function(){for(var a=[],b=this.components.length-1;b>=0;b--){var c=this.components[b];c instanceof DragLink&&a.push(c)}return a},getItems:function(){for(var a=[],b=this.components.length-1;b>=0;b--){var c=this.components[b];c instanceof DragItem&&a.push(c)}return a},destroy:function(){this._super(),Main.viewContainer.removeChild(this.itemsContainer),Main.viewContainer.removeChild(this.linksContainer),this.removeTouchListener()}}),Level=Class.extend({init:function(a,b){this.id=a,this.data=b,this.reset()},reset:function(){this.isCompleted=!1,this.isOpen=!1,this.bestTime=594e4,this.lastTime=-1},complete:function(a){this.isCompleted=!0,this.lastTime=1e3*Math.floor(a/1e3),this.lastTime<this.bestTime&&(this.bestTime=this.lastTime)},getTitle:function(){return this.data.name}}),gameDiv,canvas,stage,assets,cookies,game,focusManager,Main=ComponentBox.extend({init:function(){this._super(),this.zzz="Boo!",gameDiv=document.getElementById("gameArea"),canvas=document.getElementById("gameCanvas"),stage=new createjs.Stage(canvas);new Resizer;createjs.Touch.enable(stage,!0),createjs.Ticker.setFPS(30),stage.mouseMoveOutside=!0,stage.enableMouseOver(10),this.counter=0,createjs.Ticker.on("tick",this.tick,this),cookies=new Cookies,assets=new Assets(this.preloaderComplete,this),console.log("ZZZ")},testFunc:function(a,b){console.log("Name "+a+", profession "+b+". "+this.zzz)},preloaderComplete:function(){Config.TRANSPARENT&&(stage.alpha=.5),Main.views=[],Main.backContainer=new createjs.Container,Main.viewContainer=new createjs.Container,Main.topContainer=new createjs.Container,Main.faderContainer=new createjs.Container,stage.addChild(Main.backContainer),stage.addChild(Main.viewContainer),stage.addChild(Main.topContainer),stage.addChild(Main.faderContainer),Fader.init(),Config.SHOW_FPS&&Main.addView(new FPSView),this.back=new Background,this.addComponent(this.back),game=new Game,cookies.assignGame(game),Main.addView(new MainMenuView(game)),Sounds.startMusic(),focusManager=new FocusManager
},tick:function(a){stage.update(a),this.counter++,this.counter>=30&&(this.counter=0)}});Main.addView=function(a){Main.views.push(a)},Main.removeViewByClass=function(a){for(var b=Main.views.length-1;b>=0;b--){var c=Main.views[b];if(c instanceof a){Main.views.splice(b,1),c.destroy();break}}},Main.getViewByClass=function(a){for(var b=Main.views.length-1;b>=0;b--){var c=Main.views[b];if(c instanceof a)return c}return null};var Preloader=Class.extend({init:function(){var a=20,b=200,c=(Config.WIDTH-b)/2,d=Config.HEIGHT/2-20,e=a+10,f=b+10,g=(Config.WIDTH-f)/2,h=Config.HEIGHT/2-25;this.container=new createjs.Container,stage.addChild(this.container),this.loaderEdge=new createjs.Shape,this.loaderEdge.graphics.setStrokeStyle(2).beginStroke("#000000").drawRect(g,h,f,e).endStroke(),this.container.addChild(this.loaderEdge),this.loaderBar=new createjs.Shape,this.loaderBar.graphics.beginFill("#000000").drawRect(0,d,b,a).endFill(),this.loaderBar.x=c,this.loaderBar.scaleX=0,this.container.addChild(this.loaderBar),this.percentTf=new createjs.Text("0%","40px Arial","#555555"),this.percentTf.textAlign="center",this.percentTf.x=Config.WIDTH/2,this.percentTf.y=Config.HEIGHT/2-80,this.container.addChild(this.percentTf);var i=this.percentTf.y;createjs.Tween.get(this.percentTf,{loop:!0}).to({y:i-10},1e3,createjs.Ease.sineInOut).to({y:i},1e3,createjs.Ease.sineInOut)},update:function(a){var b=Math.round(100*a);this.percentTf.text=b+"%",this.loaderBar.scaleX=a,stage.update()},destroy:function(){createjs.Tween.removeTweens(this.percentTf),this.container.removeChild(this.loaderEdge),this.container.removeChild(this.loaderBar),this.container.removeChild(this.percentTf),stage.removeChild(this.container),stage.update()}}),Resizer=Class.extend({init:function(){Resizer.onResize=this.onResize,window.onresize=Resizer.onResize,this.onResize()},onResize:function(){var a=window.innerWidth,b=window.innerHeight,c=Config.WIDTH,d=Config.HEIGHT,e=Math.min(a/c,b/d);Config.AUTO_RESIZE||(e=1);var f=c*e,g=d*e;gameDiv.style.width=f+"px",gameDiv.style.height=g+"px",gameDiv.style.marginTop=-g/2+"px",gameDiv.style.marginLeft=-f/2+"px",stage.scaleX=e,stage.scaleY=e,stage.canvas.width=f,stage.canvas.height=g,stage.update()}}),Sounds=Class.extend({});Sounds.soundEnabled=!0,Sounds.musicChannel=void 0,Sounds.play=function(a){if(Sounds.soundEnabled){createjs.Sound.play(a)}},Sounds.toggle=function(){Sounds.soundEnabled=!Sounds.soundEnabled,Sounds.soundEnabled?Sounds.startMusic():Sounds.stopMusic()},Sounds.startMusic=function(){Sounds.soundEnabled&&(Sounds.musicChannel=createjs.Sound.play("music",{loop:-1,volume:1}))},Sounds.stopMusic=function(){Sounds.musicChannel&&Sounds.musicChannel.stop()};var texts={TUTORIAL1:"Lines are crossed.\nThey shouldn't be.",TUTORIAL2:"Touch and drag these dots\nto uncross the lines.",LEVEL:"Level ",TAPS:"Taps: ",GAME_BY:"Game by Eugene Karataev",MUSIC_BY:"Music by Kevin MacLeod"},Util=Class.extend({});Util.formatTime=function(a){var b=Math.floor(a/1e3),c=Math.floor(b/3600),d=Math.floor((b-3600*c)/60),e=b-3600*c-60*d;return 10>c&&(c="0"+c),10>d&&(d="0"+d),10>e&&(e="0"+e),d+":"+e},Util.shuffle=function(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return a};var Background=ComponentBox.extend({init:function(){this._super(),this.container=Main.backContainer,this.addComponent(new Picture(this.container,"background"))}}),Button=Component.extend({init:function(a,b,c,d,e){if(this.parent=a,this.assetName=b,this.callback=c,this.scope=d,this.x=0,this.y=0,this.center=!1,this.scale=1,e&&(void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.center&&(this.center=e.center),void 0!=e.scale&&(this.scale=e.scale)),this.bmp=new createjs.Bitmap(assets.get(this.assetName)),this.bmp.x=this.x,this.bmp.y=this.y,this.bmp.scaleX=this.bmp.scaleY=this.scale,this.parent.addChild(this.bmp),this.center){var f=this.bmp.image.width,g=this.bmp.image.height;this.bmp.regX=f/2,this.bmp.regY=g/2}this.enableClick(),this.bmp.cursor="pointer"},hide:function(){this.bmp.visible=!1},show:function(){this.bmp.visible=!0},scaleHide:function(){this.bmp.scaleX=this.bmp.scaleY=1,createjs.Tween.get(this.bmp).to({scaleX:0,scaleY:0},200)},scaleShow:function(){this.bmp.visible=!0,this.bmp.scaleX=this.bmp.scaleY=0,createjs.Tween.get(this.bmp).to({scaleX:1,scaleY:1},200)},enableClick:function(){this.bmp.addEventListener("click",this)},disableClick:function(){this.bmp.removeEventListener("click",this)},handleEvent:function(a){switch(a.type){case"click":Sounds.play("sndClick"),this.callback.call(this.scope,this)}},destroy:function(){this.disableClick(),this.parent.removeChild(this.bmp)}}),ButtonRect=Component.extend({init:function(a,b,c,d){this.parent=a,this.callback=b,this.scope=c,this.x=0,this.y=0,this.width=100,this.height=100,this.color="#FFFFFF",this.alpha=1,d&&(void 0!=d.x&&(this.x=d.x),void 0!=d.y&&(this.y=d.y),void 0!=d.width&&(this.width=d.width),void 0!=d.height&&(this.height=d.height),void 0!=d.alpha&&(this.alpha=d.alpha)),this.shape=new createjs.Shape,this.shape.graphics.beginFill(this.color).drawRect(0,0,this.width,this.height),this.shape.x=this.x,this.shape.y=this.y,this.shape.alpha=this.alpha,this.parent.addChild(this.shape),this.enableClick(),this.shape.cursor="pointer"},hide:function(){this.shape.visible=!1},show:function(){this.shape.visible=!0},enableClick:function(){this.shape.addEventListener("click",this)},disableClick:function(){this.shape.removeEventListener("click",this)},handleEvent:function(a){switch(a.type){case"click":Sounds.play("sndClick"),this.callback.call(this.scope,this)}},destroy:function(){this.disableClick(),this.parent.removeChild(this.shape)}}),Dialog=ComponentBox.extend({init:function(a,b,c){this.game=a,this.parent=b,this._super(),this.asset="levelCompleteBack",this.x=0,this.y=0,this.blockBack=!1,c&&(c.asset&&(this.asset=c.asset),void 0!=c.x&&(this.x=c.x),void 0!=c.y&&(this.y=c.y),void 0!=c.blockBack&&(this.blockBack=c.blockBack)),this.blockBack&&(this.pic=new Picture(this.parent,"blackBack"),this.addComponent(this.pic),this.pic.bitmap.addEventListener("click",this)),this.holder=new createjs.Container,this.holder.x=this.x,this.holder.y=this.y,this.parent.addChild(this.holder),this.addComponent(new Picture(this.holder,this.asset));var d=this.holder.y;this.holder.y=Config.HEIGHT,createjs.Tween.get(this.holder,{ignoreGlobalPause:!0}).to({y:d},1e3,createjs.Ease.backOut),this.blockBack&&(this.pic.bitmap.alpha=0,createjs.Tween.get(this.pic.bitmap,{ignoreGlobalPause:!0}).to({alpha:1},500))},handleEvent:function(a){switch(a.type){case"click":}},destroy:function(){this._super(),this.blockBack&&this.pic.bitmap.removeEventListener("click",this),this.parent.removeChild(this.holder)}}),DragItem=ComponentBox.extend({init:function(a,b,c,d,e){this.game=a,this.parent=b,this.levelView=c,this.id=d,this.x=0,this.y=0,this.fixed=!1,e&&(void 0!=e.x&&(this.x=e.x),void 0!=e.y&&(this.y=e.y),void 0!=e.fixed&&(this.fixed=e.fixed)),this._super(),this.container=new createjs.Container,this.parent.addChild(this.container),this.setPos(this.x,this.y),this.shape=new createjs.Shape,this.container.addChildAt(this.shape,0)},saveLinks:function(a){this.links=[];for(var b=0;b<a.length;b++){var c=a[b];(c.p1.id===this.id||c.p2.id===this.id)&&this.links.push(c)}},getLinks:function(){return this.links},render:function(){var a="#FFFFFF",b=10;if(this.fixed)a="#000000",b=10;else{b=Config.ITEM_GFX_RADIUS;for(var c=!1,d=!1,e=0;e<this.links.length;e++){var f=this.links[e];f.getState()===DragLink.STATE_NON_INTERSECT?c=!0:f.getState()===DragLink.STATE_INTERSECT&&(d=!0)}c?a=d?"#FED138":"#569D01":d&&(a="#AE0001")}var g=this.shape.graphics;g.clear(),g.beginFill(a),g.drawCircle(0,0,b),g.endFill()},getX:function(){return this.container.x},getY:function(){return this.container.y},setPos:function(a,b){this.container.x=a,this.container.y=b},moveOnTop:function(){this.parent.setChildIndex(this.container,this.parent.getNumChildren()-1)},select:function(){this.moveOnTop(),createjs.Tween.get(this.container,{override:!0,loop:!0}).to({scaleX:1.2,scaleY:1.2},200,createjs.Ease.sineInOut).to({scaleX:1,scaleY:1},200,createjs.Ease.sineInOut)},deselect:function(){createjs.Tween.get(this.container,{override:!0}).to({scaleX:1,scaleY:1},200)},destroy:function(){this._super()}}),DragLink=ComponentBox.extend({init:function(a,b,c,d){this.game=a,this.parent=b,this.p1=c,this.p2=d,this._super(),this.setState(DragLink.STATE_NON_INTERSECT),this.g=new createjs.Graphics,this.shape=new createjs.Shape(this.g),this.parent.addChild(this.shape),this.drawLink()},drawLink:function(){this.g.clear(),this.g.setStrokeStyle(5),this.g.beginStroke(this.color);100+Math.floor(200*Math.random()),100+Math.floor(200*Math.random());this.g.moveTo(this.p1.getX(),this.p1.getY()),this.g.lineTo(this.p2.getX(),this.p2.getY())},setState:function(a){this.state=a,this.color=DragLink.getColorByState(this.state)},getState:function(){return this.state},render:function(){this.drawLink()},destroy:function(){this._super(),this.parent.removeChild(this.shape)}});DragLink.STATE_INTERSECT="StateIntersect",DragLink.STATE_NON_INTERSECT="StateNonIntersect",DragLink.STATE_UNKNOWN="StateUnknown",DragLink.getColorByState=function(a){return a==DragLink.STATE_INTERSECT?"#AE0001":a==DragLink.STATE_NON_INTERSECT?"#569D01":a==DragLink.STATE_UNKNOWN?"#A5A5A5":void 0};var LevelAppear=ComponentBox.extend({init:function(a,b,c){this.logic=a,this.callback=b,this.scope=c,this._super(),Config.LEVEL_START_ANIMATION?this.start():this.callback.call(this.scope,this)},start:function(){this.items=this.logic.getItems(),this.links=this.logic.getLinks(),this.totalTime=1e3+20*this.items.length;var a,b=(this.totalTime-LevelAppear.ITEM_TIME)/this.items.length,c=(this.totalTime-LevelAppear.LINK_TIME)/this.links.length;for(a=0;a<this.items.length;a++)this.startItem(a*b,this.items[a].container);for(a=0;a<this.links.length;a++)this.startLink(a*c,this.links[a]);this.logic.linksContainer.visible=!1,this.timeObj={a:10},createjs.Tween.get(this.timeObj).to({a:20},this.totalTime).call(this.complete,[],this)},startItem:function(a,b){b.scaleX=b.scaleY=0,createjs.Tween.get(b).wait(a).to({scaleX:1,scaleY:1},LevelAppear.ITEM_TIME,createjs.Ease.backOut)},startLink:function(a,b){var c=new LinkAnim(a,this.logic.itemsContainer,b);this.addComponent(c)},complete:function(){this.logic.linksContainer.visible=!0,this.callback.call(this.scope,this)},stopAndComplete:function(){for(createjs.Tween.removeAllTweens(),i=0;i<this.items.length;i++)this.items[i].container.scaleX=this.items[i].container.scaleY=1;this.complete()}});LevelAppear.ITEM_TIME=800,LevelAppear.LINK_TIME=800;var LevelItem=ComponentBox.extend({init:function(a,b,c,d,e){if(this.game=a,this.parent=b,this.level=c,this._super(),this.holder=new createjs.Container,this.holder.x=d,this.holder.y=e,this.parent.addChild(this.holder),c.isOpen){var f,g="#000000";c.isCompleted?(f="levelItemCompleteBack",g="#39541D"):(f="levelItemBack",g="#212A56"),this.addComponent(new Button(this.holder,f,this.click,this,{center:!0}));var h=this.level.id+1;this.addComponent(new TextField(this.holder,h,{align:"center",baseline:"middle",color:g,font:"50px Arial"}))}else this.addComponent(new Picture(this.holder,"levelItemLockedBack",{center:!0}));if(c.isOpen&&c.isCompleted){var i=Util.formatTime(this.level.bestTime),j=new TextField(this.holder,i,{y:25,align:"center",color:g,font:"16px Arial"});this.addComponent(j)}},click:function(){Fader.fade(this.levelStart,this)},levelStart:function(){Main.removeViewByClass(LevelSelectView),new LevelStartCommand(this.level.id)},destroy:function(){this._super(),this.parent.removeChild(this.holder)}}),LevelsGroup=ComponentBox.extend({init:function(a,b,c){this.id=a,this.game=b,this.parent=c,this._super(),this.holder=new createjs.Container,this.holder.y=this.id*Config.HEIGHT,this.parent.addChild(this.holder);for(var d=9,e=3,f=160,g=160,h=(Config.WIDTH-f*(e-1))/2,i=200,j=this.id*d,k=(this.id+1)*d,l=0,m=j;k>m;m++){var n=this.game.levels[m];if(n){var o=h+l%e*f,p=i+Math.floor(l/e)*g,q=new LevelItem(this.game,this.holder,n,o,p);this.addComponent(q)}l++}},destroy:function(){this._super(),this.parent.removeChild(this.holder)}}),LinkAnim=ComponentBox.extend({init:function(a,b,c){this.delay=a,this.link=c,this.parent=b,this._super(),this.color=DragLink.getColorByState(c.state),this.g=new createjs.Graphics,this.shape=new createjs.Shape(this.g),this.parent.addChildAt(this.shape,0),this.g.clear(),this.g.setStrokeStyle(5),this.g.beginStroke(this.color);var d=this.link.p1.getX(),e=this.link.p1.getY(),f=this.link.p2.getX(),g=this.link.p2.getY(),h=f-d,i=g-e,j=Math.floor(Math.sqrt(h*h+i*i));this.shape.x=d+h/2,this.shape.y=e+i/2,this.g.moveTo(-j/2,0),this.g.lineTo(j/2,0);var k=Math.atan2(i,h);this.shape.rotation=180*k/Math.PI,this.shape.scaleX=0,createjs.Tween.get(this.shape).wait(this.delay).to({scaleX:1},LevelAppear.LINK_TIME,createjs.Ease.cubicOut)},destroy:function(){this.parent.removeChild(this.shape)}}),NewRecord=ComponentBox.extend({init:function(a,b){this.game=a,this.parent=b,this._super(),this.startX=180,this.startY=20,this.pic=new Picture(this.parent,"newRecord",{x:this.startX,y:this.startY}),this.addComponent(this.pic),this.pic.bitmap.alpha=0,createjs.Tween.get(this.pic.bitmap).to({alpha:1},500,createjs.Ease.linear),createjs.Tween.get(this.pic.bitmap,{loop:!0}).to({x:this.startX+10},800,createjs.Ease.sineInOut).to({x:this.startX},800,createjs.Ease.sineInOut)},destroy:function(){createjs.Tween.removeTweens(this.pic.bitmap),this._super()}}),Picture=Component.extend({init:function(a,b,c){if(this.parent=a,this.assetName=b,this.x=0,this.y=0,this.center=!1,this.childIndex=this.parent.getNumChildren(),c&&(void 0!=c.x&&(this.x=c.x),void 0!=c.y&&(this.y=c.y),void 0!=c.center&&(this.center=c.center),void 0!=c.childIndex&&(this.childIndex=c.childIndex)),this.bitmap=new createjs.Bitmap(assets.get(b)),this.bitmap.x=this.x,this.bitmap.y=this.y,this.parent.addChildAt(this.bitmap,this.childIndex),this.center){var d=this.bitmap.image.width,e=this.bitmap.image.height;this.bitmap.regX=d/2,this.bitmap.regY=e/2}},setPos:function(a,b){this.bitmap.x=a,this.bitmap.y=b},destroy:function(){this.parent.removeChild(this.bitmap)}}),SoundIcon=Component.extend({init:function(a,b,c){this.parent=a,this.holder=new createjs.Container,this.parent.addChild(this.holder),this.holder.x=b,this.holder.y=c,this.bmpOn=new createjs.Bitmap(assets.get("soundIconOn")),this.holder.addChild(this.bmpOn),this.bmpOff=new createjs.Bitmap(assets.get("soundIconOff")),this.holder.addChild(this.bmpOff),this.bmpOn.x=-42,this.bmpOn.y=-46,this.bmpOff.x=-42,this.bmpOff.y=-46,this.updateIcon(),this.holder.addEventListener("click",this)},updateIcon:function(){Sounds.soundEnabled?(this.bmpOn.visible=!0,this.bmpOff.visible=!1):(this.bmpOn.visible=!1,this.bmpOff.visible=!0)},handleEvent:function(a){switch(a.type){case"click":Sounds.toggle(),Sounds.play("sndClick"),cookies.saveSound(),this.updateIcon()}},destroy:function(){this.holder.removeEventListener("click",this),this.parent.removeChild(this.holder)}}),TextField=Component.extend({init:function(a,b,c){this.parent=a,this.x=0,this.y=0,this.color=TextField.defaultColor,this.font=TextField.defaultFont,this.align=TextField.defaultAlign,this.baseline=TextField.defaultBaseline,this.shadow=!1,this.outline=TextField.defaultOutline,c&&(c.color&&(this.color=c.color),c.x&&(this.x=c.x),c.y&&(this.y=c.y),c.font&&(this.font=c.font),c.align&&(this.align=c.align),c.baseline&&(this.baseline=c.baseline),void 0!=c.shadow&&(this.shadow=c.shadow),void 0!=c.outline&&(this.outline=c.outline)),this.tf=new createjs.Text(b,this.font,this.color),this.tf.x=this.x,this.tf.y=this.y,this.tf.textAlign=this.align,this.tf.textBaseline=this.baseline,this.tf.outline=this.outline,this.shadow&&(this.tf.shadow=new createjs.Shadow("#000000",3,3,2)),this.parent.addChild(this.tf)},setText:function(a){this.tf.text=a},destroy:function(){this.parent.removeChild(this.tf)}});TextField.defaultColor="#000000",TextField.defaultFont="bold 30px Arial",TextField.defaultAlign="left",TextField.defaultBaseline="top",TextField.defaultOutline=0;var Timer=ComponentBox.extend({init:function(a,b,c){this.game=a,this.parent=b,this._super(),this.x=0,this.y=0,c&&(void 0!=c.x&&(this.x=c.x),void 0!=c.y&&(this.y=c.y)),this.container=new createjs.Container,this.parent.addChild(this.container),this.container.x=this.x,this.container.y=this.y,this.addComponent(new Picture(this.container,"timerIcon",{x:45,y:50,center:!0}));var d=Util.formatTime(0);this.timeTf=new TextField(this.container,d,{x:140,y:30,font:"37px Arial",align:"center"}),this.addComponent(this.timeTf)},setTime:function(a){var b=Util.formatTime(a);this.timeTf.setText(b)}}),Tutorial=ComponentBox.extend({init:function(a,b){this.game=a,this.parent=b,this._super(),0==this.game.curLevel.id&&(this.addText(texts.TUTORIAL1,110,500),this.addText(texts.TUTORIAL2,600,2e3))},addText:function(a,b,c){var d=new TextField(this.parent,a,{x:Config.WIDTH/2,y:b,align:"center",font:"34px Arial",color:"#000000"});this.addComponent(d),d.tf.alpha=0,d.tf.y-=10,createjs.Tween.get(d.tf).wait(c).to({alpha:1,y:d.tf.y+10},1e3,createjs.Ease.quadOut)}}),CreditsView=Dialog.extend({init:function(a){this._super(a,Main.viewContainer,{asset:"creditsBox",x:60,y:60,blockBack:!0}),this.addComponent(new Button(this.holder,"closeButton",this.closeClick,this,{x:507,y:40,center:!0})),this.logoBt=new Button(this.holder,"postepennoLogo",this.logoClick,this,{x:120,y:104}),this.addComponent(this.logoBt),this.addHitArea(this.logoBt.bmp),this.addComponent(new TextField(this.holder,texts.GAME_BY,{x:260,y:470,align:"center",font:"bold 40px PT Sans Narrow"})),this.addComponent(new TextField(this.holder,"eugene.karataev@gmail.com",{x:260,y:520,align:"center",font:"bold 36px PT Sans Narrow"})),this.addComponent(new ButtonRect(this.holder,this.karataevClick,this,{x:60,y:470,width:390,height:100,alpha:.01}))},addHitArea:function(a){var b=new createjs.Shape;b.graphics.beginFill("#000").drawRect(0,0,a.image.width,a.image.height),a.hitArea=b},karataevClick:function(){window.location.href="mailto:eugene.karataev@gmail.com"},logoClick:function(){window.open("http://postepenno.com","_blank")},closeClick:function(){Main.removeViewByClass(CreditsView)}}),DeleteProgressView=Dialog.extend({init:function(a){this._super(a,Main.viewContainer,{asset:"clearProgressBox",x:100,y:150,blockBack:!0}),this.addComponent(new Button(this.holder,"yesButton",this.yesClick,this,{x:120,y:210,center:!0})),this.addComponent(new Button(this.holder,"noButton",this.noClick,this,{x:320,y:210,center:!0}))},yesClick:function(){cookies.clear(),Main.removeViewByClass(DeleteProgressView)},noClick:function(){Main.removeViewByClass(DeleteProgressView)}}),EditorView=ComponentBox.extend({init:function(a){this.game=a,this._super();this.addComponent(new Picture(Main.viewContainer,"levelUIBack")),this.addComponent(new Button(Main.viewContainer,"restartButton",this.restartClick,this,{x:50,y:50,center:!0})),this.addComponent(new Button(Main.viewContainer,"shuffleButton",this.shuffleClick,this,{x:150,y:50,center:!0})),this.addComponent(new Button(Main.viewContainer,"saveButton",this.saveClick,this,{x:250,y:50,center:!0})),this.isCtrl=!1},saveClick:function(){this.game.saveLevel()},shuffleClick:function(){this.game.shuffleItems()},restartClick:function(){console.log("OOOPS. Not fixed yet")},keyUpHandler:function(a){17==a.keyCode&&(this.isCtrl=!1),console.log(self)},keyDownHandler:function(a){17==a.keyCode&&(this.isCtrl=!0)}}),FPSView=ComponentBox.extend({init:function(){this._super(),this.fpsLabel=new TextField(Main.faderContainer,"FPS",{x:0,y:692,font:"bold 18px Arial"}),this.addComponent(this.fpsLabel),this.tickRef=createjs.Ticker.on("tick",this.tick,this)},tick:function(){var a=Math.round(createjs.Ticker.getMeasuredFPS());this.fpsLabel.setText("FPS "+a)},destroy:function(){this._super(),createjs.Ticker.off("tick",this.tickRef)}}),Fader=Class.extend({});Fader.init=function(){Fader.pic=new Picture(Main.faderContainer,"fader"),Fader.pic.bitmap.addEventListener("click",Fader),Fader.pic.bitmap.visible=!1},Fader.handleEvent=function(){},Fader.fade=function(a,b){Fader.pic.bitmap.visible=!0,Fader.pic.bitmap.alpha=0,createjs.Tween.get(Fader.pic.bitmap,{ignoreGlobalPause:!0}).to({alpha:1},300).call(a,[],b).to({alpha:0},300).call(Fader.fadeComplete)},Fader.fadeComplete=function(){Fader.pic.bitmap.visible=!1};var FocusLostView=Dialog.extend({init:function(a,b){this._super(b,a,{asset:"focusLostBox",x:100,y:200,blockBack:!0}),this.addComponent(new Button(this.holder,"nextButton",this.resumeClick,this,{x:220,y:210,center:!0}))},resumeClick:function(){Main.removeViewByClass(FocusLostView),focusManager.resume()}}),GameCompleteView=Dialog.extend({init:function(a){this._super(a,Main.viewContainer,{asset:"gameCompleteBox",x:60,y:60,blockBack:!1}),this.addComponent(new Button(this.holder,"homeButton",this.exitClick,this,{x:260,y:500,center:!0}))},exitClick:function(){Fader.fade(this.goExit,this)},goExit:function(){Main.removeViewByClass(GameCompleteView),Main.addView(new MainMenuView(game))},destroy:function(){this._super()}}),LevelCompleteView=Dialog.extend({init:function(a){this._super(a,Main.viewContainer,{asset:"levelCompleteBack",x:100,y:400,blockBack:!1}),this.nextButton=new Button(this.holder,"nextButton",this.nextClick,this,{x:220,y:180,center:!0}),this.addComponent(this.nextButton),createjs.Tween.get(this.nextButton.bmp,{loop:!0}).to({scaleX:1.2,scaleY:1.2},1e3,createjs.Ease.sineInOut).to({scaleX:1,scaleY:1},1e3,createjs.Ease.sineInOut)},nextClick:function(){new LevelNextCommand},destroy:function(){createjs.Tween.removeTweens(this.nextButton.bmp),this._super()}}),LevelSelectView=ComponentBox.extend({init:function(a){this.game=a,this._super(),this.itemsContainer=new createjs.Container,Main.viewContainer.addChild(this.itemsContainer),this.groups=[];for(var b=0;3>b;b++){var c=new LevelsGroup(b,this.game,this.itemsContainer);this.addComponent(c),this.groups.push(c)}this.addComponent(new Picture(Main.viewContainer,"levelSelectTitle",{x:0,y:10}));var d=new Button(Main.viewContainer,"homeButton",this.homeClick,this,{x:70,y:650,center:!0});this.addComponent(d),this.scrollUp=new Button(Main.viewContainer,"upButton",this.scrollUpClick,this,{x:570,y:650,center:!0}),this.addComponent(this.scrollUp),this.scrollDown=new Button(Main.viewContainer,"downButton",this.scrollDownClick,this,{x:450,y:650,center:!0}),this.addComponent(this.scrollDown),this.timer=new Timer(this.game,Main.topContainer,{x:170,y:600}),this.addComponent(this.timer),this.timer.setTime(this.game.getTotalTime()),this.itemsContainer.y=-Config.HEIGHT*LevelSelectView.CURRENT_GROUP_ID,0==LevelSelectView.CURRENT_GROUP_ID?this.scrollUp.hide():2==LevelSelectView.CURRENT_GROUP_ID&&this.scrollDown.hide()},scrollUpClick:function(){1==LevelSelectView.CURRENT_GROUP_ID?this.scrollUp.scaleHide():2==LevelSelectView.CURRENT_GROUP_ID&&this.scrollDown.scaleShow(),LevelSelectView.CURRENT_GROUP_ID--,this.scrollUp.disableClick(),this.scrollDown.disableClick(),createjs.Tween.get(this.itemsContainer).to({y:-Config.HEIGHT*LevelSelectView.CURRENT_GROUP_ID},500,createjs.Ease.quadInOut).call(this.scrollComplete,[],this)},scrollDownClick:function(){0==LevelSelectView.CURRENT_GROUP_ID?this.scrollUp.scaleShow():1==LevelSelectView.CURRENT_GROUP_ID&&this.scrollDown.scaleHide(),LevelSelectView.CURRENT_GROUP_ID++,this.scrollUp.disableClick(),this.scrollDown.disableClick(),createjs.Tween.get(this.itemsContainer).to({y:-Config.HEIGHT*LevelSelectView.CURRENT_GROUP_ID},500,createjs.Ease.quadInOut).call(this.scrollComplete,[],this)},scrollComplete:function(){this.scrollUp.enableClick(),this.scrollDown.enableClick()},homeClick:function(){Fader.fade(this.goHome,this)},goHome:function(){Main.removeViewByClass(LevelSelectView),Main.addView(new MainMenuView(this.game))},destroy:function(){this._super(),Main.viewContainer.removeChild(this.itemsContainer)}});LevelSelectView.CURRENT_GROUP_ID=0;var LevelView=ComponentBox.extend({init:function(a){this.game=a,this._super(),this.addComponent(new Picture(Main.topContainer,"levelUIBack")),this.addComponent(new Button(Main.topContainer,"restartButton",this.restartClick,this,{x:480,y:50,center:!0})),this.addComponent(new Button(Main.topContainer,"pauseButton",this.pauseClick,this,{x:590,y:50,center:!0})),this.addComponent(new SoundIcon(Main.topContainer,370,50)),this.timer=new Timer(this.game,Main.topContainer,{x:0,y:0}),this.addComponent(this.timer);var b=this.game.curLevel.id+1;this.levelNumText=new TextField(Main.viewContainer,b,{x:Config.WIDTH/2,y:Config.HEIGHT/2+35,align:"center",baseline:"middle",font:"500px Arial",color:"#ffffff"}),this.addComponent(this.levelNumText),this.addComponent(new Tutorial(this.game,Main.viewContainer))},update:function(){this.timer.setTime(this.game.levelTime)},levelComplete:function(){this.game.curLevel.lastTime==this.game.curLevel.bestTime&&this.addComponent(new NewRecord(this.game,Main.topContainer))},pauseClick:function(){this.game.tickerPause(),Main.addView(new PauseView(Main.topContainer,this.game))},restartClick:function(){var a=this.game.curLevel.id;new LevelAbortCommand,new LevelStartCommand(a)},destroy:function(){this._super()}}),MainMenuView=ComponentBox.extend({init:function(a){this.game=a,this._super(),this.title=new Picture(Main.viewContainer,"gameTitle",{x:150,y:30}),this.addComponent(this.title),this.playButton=new Button(Main.viewContainer,"playButton2",this.playClick,this,{x:320,y:620,center:!0}),createjs.Tween.get(this.playButton.bmp,{loop:!0}).to({scaleX:1.2,scaleY:1.2},1e3,createjs.Ease.sineInOut).to({scaleX:1,scaleY:1},1e3,createjs.Ease.sineInOut),this.addComponent(this.playButton),this.soundIcon=new SoundIcon(Main.viewContainer,580,60),this.addComponent(this.soundIcon),this.deleteProgress=new Button(Main.viewContainer,"restartButton",this.clearProgressClick,this,{x:580,y:650,center:!0}),this.addComponent(this.deleteProgress),this.credits=new Button(Main.viewContainer,"creditsButton",this.creditsClick,this,{x:60,y:650,center:!0}),this.addComponent(this.credits);var b="v "+Config.VERSION;this.addComponent(new TextField(Main.viewContainer,b,{x:2,y:0,color:"#000000",font:"10px Arial"})),this.showWithTweens()},showWithTweens:function(){this.title.bitmap.alpha=0,createjs.Tween.get(this.title.bitmap).to({alpha:1},800,createjs.Ease.linear),this.tweenScaleButton(this.soundIcon.holder,800),this.tweenScaleButton(this.credits.bmp,1e3),this.tweenScaleButton(this.deleteProgress.bmp,1200),this.tweenAlphaButton(this.playButton.bmp,1400)},tweenScaleButton:function(a,b){a.scaleX=a.scaleY=0,createjs.Tween.get(a).wait(b).to({scaleX:1,scaleY:1},500,createjs.Ease.backOut)},tweenAlphaButton:function(a,b){a.alpha=0,createjs.Tween.get(a).wait(b).to({alpha:1},500,createjs.Ease.linear)},editorClick:function(){Main.removeViewByClass(MainMenuView);var a=new Editor;a.levelStart()},creditsClick:function(){Main.addView(new CreditsView(this.game))},clearProgressClick:function(){Main.addView(new DeleteProgressView(this.game))},playClick:function(){Fader.fade(this.gameStart,this)},gameStart:function(){Main.removeViewByClass(MainMenuView),Config.TEST_GAME_COMPLETE?new GameCompleteCommand:cookies.isNewGame?new LevelStartCommand(0):Main.addView(new LevelSelectView(this.game))}}),PauseView=Dialog.extend({init:function(a,b){this._super(b,a,{asset:"pauseBox",x:100,y:200,blockBack:!0}),this.addComponent(new Button(this.holder,"levelsButton",this.exitClick,this,{x:130,y:210,center:!0})),this.addComponent(new Button(this.holder,"nextButton",this.resumeClick,this,{x:310,y:210,center:!0}))},resumeClick:function(){this.game.tickerResume(),Main.removeViewByClass(PauseView)},exitClick:function(){this.game.tickerResume(),Fader.fade(this.goExit,this)},goExit:function(){new LevelAbortCommand,Main.addView(new LevelSelectView(game))}});